Update EVENT_4106 set CpmErabEstabAttInitPaLsm = (case when ERABSETUPATTACCTYPE = 2 then 1 else 0 end) + 
(case when ERABSETUPATTACCTYPE_1 = 2 then 1 else 0 end) +
(case when ERABSETUPATTACCTYPE_2 = 2 then 1 else 0 end) +
(case when ERABSETUPATTACCTYPE_3 = 2 then 1 else 0 end) +
(case when ERABSETUPATTACCTYPE_4 = 2 then 1 else 0 end) +
(case when ERABSETUPATTACCTYPE_5 = 2 then 1 else 0 end) +
(case when ERABSETUPATTACCTYPE_6 = 2 then 1 else 0 end) +
(case when ERABSETUPATTACCTYPE_7 = 2 then 1 else 0 end) +
(case when ERABSETUPATTACCTYPE_8 = 2 then 1 else 0 end) +
(case when ERABSETUPATTACCTYPE_9 = 2 then 1 else 0 end) +
(case when ERABSETUPATTACCTYPE_10 = 2 then 1 else 0 end) +
(case when ERABSETUPATTACCTYPE_11 = 2 then 1 else 0 end) +
(case when ERABSETUPATTACCTYPE_12 = 2 then 1 else 0 end) +
(case when ERABSETUPATTACCTYPE_13 = 2 then 1 else 0 end) +
(case when ERABSETUPATTACCTYPE_14 = 2 then 1 else 0 end) +
(case when ERABSETUPATTACCTYPE_15 = 2 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitMiscS1Cause0 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 4 and ERABSETUPFAILURE3GPPCAUSE = 0 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 4  and ERABSETUPFAILURE3GPPCAUSE_1 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 4 and ERABSETUPFAILURE3GPPCAUSE_2 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 4 and ERABSETUPFAILURE3GPPCAUSE_3 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 4 and ERABSETUPFAILURE3GPPCAUSE_4 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 4 and ERABSETUPFAILURE3GPPCAUSE_5 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 4 and ERABSETUPFAILURE3GPPCAUSE_6 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 4 and ERABSETUPFAILURE3GPPCAUSE_7 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 4 and ERABSETUPFAILURE3GPPCAUSE_8 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 4 and ERABSETUPFAILURE3GPPCAUSE_9 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 4 and ERABSETUPFAILURE3GPPCAUSE_10 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 4 and ERABSETUPFAILURE3GPPCAUSE_11 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 4 and ERABSETUPFAILURE3GPPCAUSE_12 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 4 and ERABSETUPFAILURE3GPPCAUSE_13 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 4 and ERABSETUPFAILURE3GPPCAUSE_14 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 4 and ERABSETUPFAILURE3GPPCAUSE_15 = 0 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitMiscS1Cause1 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 4 and ERABSETUPFAILURE3GPPCAUSE = 1 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 4 and ERABSETUPFAILURE3GPPCAUSE_1 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 4 and ERABSETUPFAILURE3GPPCAUSE_2 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 4 and ERABSETUPFAILURE3GPPCAUSE_3 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 4 and ERABSETUPFAILURE3GPPCAUSE_4 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 4 and ERABSETUPFAILURE3GPPCAUSE_5 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 4 and ERABSETUPFAILURE3GPPCAUSE_6 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 4 and ERABSETUPFAILURE3GPPCAUSE_7 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 4 and ERABSETUPFAILURE3GPPCAUSE_8 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 4 and ERABSETUPFAILURE3GPPCAUSE_9 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 4 and ERABSETUPFAILURE3GPPCAUSE_10 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 4 and ERABSETUPFAILURE3GPPCAUSE_11 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 4 and ERABSETUPFAILURE3GPPCAUSE_12 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 4 and ERABSETUPFAILURE3GPPCAUSE_13 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 4 and ERABSETUPFAILURE3GPPCAUSE_14 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 4 and ERABSETUPFAILURE3GPPCAUSE_15 = 1 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitMiscS1Cause2 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 4 and ERABSETUPFAILURE3GPPCAUSE = 2 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 4 and ERABSETUPFAILURE3GPPCAUSE_1 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 4 and ERABSETUPFAILURE3GPPCAUSE_2 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 4 and ERABSETUPFAILURE3GPPCAUSE_3 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 4 and ERABSETUPFAILURE3GPPCAUSE_4 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 4 and ERABSETUPFAILURE3GPPCAUSE_5 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 4 and ERABSETUPFAILURE3GPPCAUSE_6 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 4 and ERABSETUPFAILURE3GPPCAUSE_7 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 4 and ERABSETUPFAILURE3GPPCAUSE_8 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 4 and ERABSETUPFAILURE3GPPCAUSE_9 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 4 and ERABSETUPFAILURE3GPPCAUSE_10 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 4 and ERABSETUPFAILURE3GPPCAUSE_11 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 4 and ERABSETUPFAILURE3GPPCAUSE_12 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 4 and ERABSETUPFAILURE3GPPCAUSE_13 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 4 and ERABSETUPFAILURE3GPPCAUSE_14 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 4 and ERABSETUPFAILURE3GPPCAUSE_15 = 2 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitMiscS1Cause3 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 4 and ERABSETUPFAILURE3GPPCAUSE = 3 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 4 and ERABSETUPFAILURE3GPPCAUSE_1 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 4 and ERABSETUPFAILURE3GPPCAUSE_2 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 4 and ERABSETUPFAILURE3GPPCAUSE_3 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 4 and ERABSETUPFAILURE3GPPCAUSE_4 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 4 and ERABSETUPFAILURE3GPPCAUSE_5 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 4 and ERABSETUPFAILURE3GPPCAUSE_6 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 4 and ERABSETUPFAILURE3GPPCAUSE_7 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 4 and ERABSETUPFAILURE3GPPCAUSE_8 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 4 and ERABSETUPFAILURE3GPPCAUSE_9 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 4 and ERABSETUPFAILURE3GPPCAUSE_10 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 4 and ERABSETUPFAILURE3GPPCAUSE_11 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 4 and ERABSETUPFAILURE3GPPCAUSE_12 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 4 and ERABSETUPFAILURE3GPPCAUSE_13 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 4 and ERABSETUPFAILURE3GPPCAUSE_14 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 4 and ERABSETUPFAILURE3GPPCAUSE_15 = 3 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitMiscS1Cause4 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 4 and ERABSETUPFAILURE3GPPCAUSE = 4 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 4 and ERABSETUPFAILURE3GPPCAUSE_1 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 4 and ERABSETUPFAILURE3GPPCAUSE_2 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 4 and ERABSETUPFAILURE3GPPCAUSE_3 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 4 and ERABSETUPFAILURE3GPPCAUSE_4 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 4 and ERABSETUPFAILURE3GPPCAUSE_5 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 4 and ERABSETUPFAILURE3GPPCAUSE_6 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 4 and ERABSETUPFAILURE3GPPCAUSE_7 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 4 and ERABSETUPFAILURE3GPPCAUSE_8 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 4 and ERABSETUPFAILURE3GPPCAUSE_9 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 4 and ERABSETUPFAILURE3GPPCAUSE_10 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 4 and ERABSETUPFAILURE3GPPCAUSE_11 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 4 and ERABSETUPFAILURE3GPPCAUSE_12 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 4 and ERABSETUPFAILURE3GPPCAUSE_13 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 4 and ERABSETUPFAILURE3GPPCAUSE_14 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 4 and ERABSETUPFAILURE3GPPCAUSE_15 = 4 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitMiscS1Cause5 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 4 and ERABSETUPFAILURE3GPPCAUSE = 5 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 4 and ERABSETUPFAILURE3GPPCAUSE_1 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 4 and ERABSETUPFAILURE3GPPCAUSE_2 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 4 and ERABSETUPFAILURE3GPPCAUSE_3 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 4 and ERABSETUPFAILURE3GPPCAUSE_4 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 4 and ERABSETUPFAILURE3GPPCAUSE_5 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 4 and ERABSETUPFAILURE3GPPCAUSE_6 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 4 and ERABSETUPFAILURE3GPPCAUSE_7 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 4 and ERABSETUPFAILURE3GPPCAUSE_8 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 4 and ERABSETUPFAILURE3GPPCAUSE_9 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 4 and ERABSETUPFAILURE3GPPCAUSE_10 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 4 and ERABSETUPFAILURE3GPPCAUSE_11 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 4 and ERABSETUPFAILURE3GPPCAUSE_12 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 4 and ERABSETUPFAILURE3GPPCAUSE_13 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 4 and ERABSETUPFAILURE3GPPCAUSE_14 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 4 and ERABSETUPFAILURE3GPPCAUSE_15 = 5 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

--CpmErabEstabFailInitNasS1Cause$
Update EVENT_4106 set CpmErabEstabFailInitNasS1Cause0 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 2  AND ERABSETUPFAILURE3GPPCAUSE = 0 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 2 AND ERABSETUPFAILURE3GPPCAUSE_1 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 2 AND ERABSETUPFAILURE3GPPCAUSE_2 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 2 AND ERABSETUPFAILURE3GPPCAUSE_3 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 2 AND ERABSETUPFAILURE3GPPCAUSE_4 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 2 AND ERABSETUPFAILURE3GPPCAUSE_5 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 2 AND ERABSETUPFAILURE3GPPCAUSE_6 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 2 AND ERABSETUPFAILURE3GPPCAUSE_7 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 2 AND ERABSETUPFAILURE3GPPCAUSE_8 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 2 AND ERABSETUPFAILURE3GPPCAUSE_9 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 2 AND ERABSETUPFAILURE3GPPCAUSE_10 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 2 AND ERABSETUPFAILURE3GPPCAUSE_11 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 2 AND ERABSETUPFAILURE3GPPCAUSE_12 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 2 AND ERABSETUPFAILURE3GPPCAUSE_13 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 2 AND ERABSETUPFAILURE3GPPCAUSE_14 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 2 AND ERABSETUPFAILURE3GPPCAUSE_15 = 0 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;


Update EVENT_4106 set CpmErabEstabFailInitNasS1Cause1 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 2  AND ERABSETUPFAILURE3GPPCAUSE = 1 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 2 AND ERABSETUPFAILURE3GPPCAUSE_1 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 2 AND ERABSETUPFAILURE3GPPCAUSE_2 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 2 AND ERABSETUPFAILURE3GPPCAUSE_3 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 2 AND ERABSETUPFAILURE3GPPCAUSE_4 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 2 AND ERABSETUPFAILURE3GPPCAUSE_5 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 2 AND ERABSETUPFAILURE3GPPCAUSE_6 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 2 AND ERABSETUPFAILURE3GPPCAUSE_7 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 2 AND ERABSETUPFAILURE3GPPCAUSE_8 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 2 AND ERABSETUPFAILURE3GPPCAUSE_9 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 2 AND ERABSETUPFAILURE3GPPCAUSE_10 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 2 AND ERABSETUPFAILURE3GPPCAUSE_11 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 2 AND ERABSETUPFAILURE3GPPCAUSE_12 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 2 AND ERABSETUPFAILURE3GPPCAUSE_13 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 2 AND ERABSETUPFAILURE3GPPCAUSE_14 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 2 AND ERABSETUPFAILURE3GPPCAUSE_15 = 1 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitNasS1Cause2 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 2  AND ERABSETUPFAILURE3GPPCAUSE = 2 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 2 AND ERABSETUPFAILURE3GPPCAUSE_1 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 2 AND ERABSETUPFAILURE3GPPCAUSE_2 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 2 AND ERABSETUPFAILURE3GPPCAUSE_3 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 2 AND ERABSETUPFAILURE3GPPCAUSE_4 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 2 AND ERABSETUPFAILURE3GPPCAUSE_5 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 2 AND ERABSETUPFAILURE3GPPCAUSE_6 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 2 AND ERABSETUPFAILURE3GPPCAUSE_7 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 2 AND ERABSETUPFAILURE3GPPCAUSE_8 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 2 AND ERABSETUPFAILURE3GPPCAUSE_9 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 2 AND ERABSETUPFAILURE3GPPCAUSE_10 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 2 AND ERABSETUPFAILURE3GPPCAUSE_11 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 2 AND ERABSETUPFAILURE3GPPCAUSE_12 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 2 AND ERABSETUPFAILURE3GPPCAUSE_13 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 2 AND ERABSETUPFAILURE3GPPCAUSE_14 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 2 AND ERABSETUPFAILURE3GPPCAUSE_15 = 2 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitNasS1Cause3 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 2  AND ERABSETUPFAILURE3GPPCAUSE = 3 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 2 AND ERABSETUPFAILURE3GPPCAUSE_1 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 2 AND ERABSETUPFAILURE3GPPCAUSE_2 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 2 AND ERABSETUPFAILURE3GPPCAUSE_3 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 2 AND ERABSETUPFAILURE3GPPCAUSE_4 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 2 AND ERABSETUPFAILURE3GPPCAUSE_5 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 2 AND ERABSETUPFAILURE3GPPCAUSE_6 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 2 AND ERABSETUPFAILURE3GPPCAUSE_7 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 2 AND ERABSETUPFAILURE3GPPCAUSE_8 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 2 AND ERABSETUPFAILURE3GPPCAUSE_9 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 2 AND ERABSETUPFAILURE3GPPCAUSE_10 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 2 AND ERABSETUPFAILURE3GPPCAUSE_11 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 2 AND ERABSETUPFAILURE3GPPCAUSE_12 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 2 AND ERABSETUPFAILURE3GPPCAUSE_13 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 2 AND ERABSETUPFAILURE3GPPCAUSE_14 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 2 AND ERABSETUPFAILURE3GPPCAUSE_15 = 3 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitNasS1Cause4 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 2  AND ERABSETUPFAILURE3GPPCAUSE = 4 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 2 AND ERABSETUPFAILURE3GPPCAUSE_1 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 2 AND ERABSETUPFAILURE3GPPCAUSE_2 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 2 AND ERABSETUPFAILURE3GPPCAUSE_3 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 2 AND ERABSETUPFAILURE3GPPCAUSE_4 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 2 AND ERABSETUPFAILURE3GPPCAUSE_5 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 2 AND ERABSETUPFAILURE3GPPCAUSE_6 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 2 AND ERABSETUPFAILURE3GPPCAUSE_7 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 2 AND ERABSETUPFAILURE3GPPCAUSE_8 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 2 AND ERABSETUPFAILURE3GPPCAUSE_9 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 2 AND ERABSETUPFAILURE3GPPCAUSE_10 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 2 AND ERABSETUPFAILURE3GPPCAUSE_11 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 2 AND ERABSETUPFAILURE3GPPCAUSE_12 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 2 AND ERABSETUPFAILURE3GPPCAUSE_13 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 2 AND ERABSETUPFAILURE3GPPCAUSE_14 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 2 AND ERABSETUPFAILURE3GPPCAUSE_15 = 4 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

--CpmErabEstabFailInitProtS1Cause$

Update EVENT_4106 set CpmErabEstabFailInitProtS1Cause0 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 3 AND ERABSETUPFAILURE3GPPCAUSE = 0 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 3 AND ERABSETUPFAILURE3GPPCAUSE_1 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 3 AND ERABSETUPFAILURE3GPPCAUSE_2 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 3 AND ERABSETUPFAILURE3GPPCAUSE_3 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 3 AND ERABSETUPFAILURE3GPPCAUSE_4 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 3 AND ERABSETUPFAILURE3GPPCAUSE_5 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 3 AND ERABSETUPFAILURE3GPPCAUSE_6 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 3 AND ERABSETUPFAILURE3GPPCAUSE_7 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 3 AND ERABSETUPFAILURE3GPPCAUSE_8 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 3 AND ERABSETUPFAILURE3GPPCAUSE_9 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 3 AND ERABSETUPFAILURE3GPPCAUSE_10 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 3 AND ERABSETUPFAILURE3GPPCAUSE_11 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 3 AND ERABSETUPFAILURE3GPPCAUSE_12 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 3 AND ERABSETUPFAILURE3GPPCAUSE_13 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 3 AND ERABSETUPFAILURE3GPPCAUSE_14 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 3 AND ERABSETUPFAILURE3GPPCAUSE_15 = 0 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitProtS1Cause1 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 3 AND ERABSETUPFAILURE3GPPCAUSE = 1 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 3 AND ERABSETUPFAILURE3GPPCAUSE_1 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 3 AND ERABSETUPFAILURE3GPPCAUSE_2 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 3 AND ERABSETUPFAILURE3GPPCAUSE_3 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 3 AND ERABSETUPFAILURE3GPPCAUSE_4 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 3 AND ERABSETUPFAILURE3GPPCAUSE_5 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 3 AND ERABSETUPFAILURE3GPPCAUSE_6 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 3 AND ERABSETUPFAILURE3GPPCAUSE_7 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 3 AND ERABSETUPFAILURE3GPPCAUSE_8 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 3 AND ERABSETUPFAILURE3GPPCAUSE_9 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 3 AND ERABSETUPFAILURE3GPPCAUSE_10 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 3 AND ERABSETUPFAILURE3GPPCAUSE_11 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 3 AND ERABSETUPFAILURE3GPPCAUSE_12 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 3 AND ERABSETUPFAILURE3GPPCAUSE_13 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 3 AND ERABSETUPFAILURE3GPPCAUSE_14 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 3 AND ERABSETUPFAILURE3GPPCAUSE_15 = 1 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitProtS1Cause2 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 3 AND ERABSETUPFAILURE3GPPCAUSE = 2 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 3 AND ERABSETUPFAILURE3GPPCAUSE_1 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 3 AND ERABSETUPFAILURE3GPPCAUSE_2 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 3 AND ERABSETUPFAILURE3GPPCAUSE_3 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 3 AND ERABSETUPFAILURE3GPPCAUSE_4 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 3 AND ERABSETUPFAILURE3GPPCAUSE_5 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 3 AND ERABSETUPFAILURE3GPPCAUSE_6 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 3 AND ERABSETUPFAILURE3GPPCAUSE_7 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 3 AND ERABSETUPFAILURE3GPPCAUSE_8 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 3 AND ERABSETUPFAILURE3GPPCAUSE_9 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 3 AND ERABSETUPFAILURE3GPPCAUSE_10 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 3 AND ERABSETUPFAILURE3GPPCAUSE_11 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 3 AND ERABSETUPFAILURE3GPPCAUSE_12 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 3 AND ERABSETUPFAILURE3GPPCAUSE_13 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 3 AND ERABSETUPFAILURE3GPPCAUSE_14 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 3 AND ERABSETUPFAILURE3GPPCAUSE_15 = 2 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitProtS1Cause3 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 3 AND ERABSETUPFAILURE3GPPCAUSE = 3 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 3 AND ERABSETUPFAILURE3GPPCAUSE_1 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 3 AND ERABSETUPFAILURE3GPPCAUSE_2 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 3 AND ERABSETUPFAILURE3GPPCAUSE_3 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 3 AND ERABSETUPFAILURE3GPPCAUSE_4 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 3 AND ERABSETUPFAILURE3GPPCAUSE_5 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 3 AND ERABSETUPFAILURE3GPPCAUSE_6 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 3 AND ERABSETUPFAILURE3GPPCAUSE_7 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 3 AND ERABSETUPFAILURE3GPPCAUSE_8 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 3 AND ERABSETUPFAILURE3GPPCAUSE_9 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 3 AND ERABSETUPFAILURE3GPPCAUSE_10 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 3 AND ERABSETUPFAILURE3GPPCAUSE_11 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 3 AND ERABSETUPFAILURE3GPPCAUSE_12 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 3 AND ERABSETUPFAILURE3GPPCAUSE_13 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 3 AND ERABSETUPFAILURE3GPPCAUSE_14 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 3 AND ERABSETUPFAILURE3GPPCAUSE_15 = 3 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitProtS1Cause4 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 4 AND ERABSETUPFAILURE3GPPCAUSE = 0 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 3 AND ERABSETUPFAILURE3GPPCAUSE_1 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 3 AND ERABSETUPFAILURE3GPPCAUSE_2 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 3 AND ERABSETUPFAILURE3GPPCAUSE_3 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 3 AND ERABSETUPFAILURE3GPPCAUSE_4 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 3 AND ERABSETUPFAILURE3GPPCAUSE_5 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 3 AND ERABSETUPFAILURE3GPPCAUSE_6 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 3 AND ERABSETUPFAILURE3GPPCAUSE_7 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 3 AND ERABSETUPFAILURE3GPPCAUSE_8 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 3 AND ERABSETUPFAILURE3GPPCAUSE_9 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 3 AND ERABSETUPFAILURE3GPPCAUSE_10 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 3 AND ERABSETUPFAILURE3GPPCAUSE_11 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 3 AND ERABSETUPFAILURE3GPPCAUSE_12 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 3 AND ERABSETUPFAILURE3GPPCAUSE_13 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 3 AND ERABSETUPFAILURE3GPPCAUSE_14 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 3 AND ERABSETUPFAILURE3GPPCAUSE_15 = 4 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitProtS1Cause5 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 3 AND ERABSETUPFAILURE3GPPCAUSE = 5 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 3 AND ERABSETUPFAILURE3GPPCAUSE_1 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 3 AND ERABSETUPFAILURE3GPPCAUSE_2 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 3 AND ERABSETUPFAILURE3GPPCAUSE_3 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 3 AND ERABSETUPFAILURE3GPPCAUSE_4 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 3 AND ERABSETUPFAILURE3GPPCAUSE_5 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 3 AND ERABSETUPFAILURE3GPPCAUSE_6 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 3 AND ERABSETUPFAILURE3GPPCAUSE_7 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 3 AND ERABSETUPFAILURE3GPPCAUSE_8 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 3 AND ERABSETUPFAILURE3GPPCAUSE_9 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 3 AND ERABSETUPFAILURE3GPPCAUSE_10 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 3 AND ERABSETUPFAILURE3GPPCAUSE_11 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 3 AND ERABSETUPFAILURE3GPPCAUSE_12 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 3 AND ERABSETUPFAILURE3GPPCAUSE_13 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 3 AND ERABSETUPFAILURE3GPPCAUSE_14 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 3 AND ERABSETUPFAILURE3GPPCAUSE_15 = 5 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitProtS1Cause6 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 3 AND ERABSETUPFAILURE3GPPCAUSE = 6 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 3 AND ERABSETUPFAILURE3GPPCAUSE_1 = 6 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 3 AND ERABSETUPFAILURE3GPPCAUSE_2 = 6 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 3 AND ERABSETUPFAILURE3GPPCAUSE_3 = 6 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 3 AND ERABSETUPFAILURE3GPPCAUSE_4 = 6 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 3 AND ERABSETUPFAILURE3GPPCAUSE_5 = 6 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 3 AND ERABSETUPFAILURE3GPPCAUSE_6 = 6 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 3 AND ERABSETUPFAILURE3GPPCAUSE_7 = 6 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 3 AND ERABSETUPFAILURE3GPPCAUSE_8 = 6 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 3 AND ERABSETUPFAILURE3GPPCAUSE_9 = 6 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 3 AND ERABSETUPFAILURE3GPPCAUSE_10 = 6 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 3 AND ERABSETUPFAILURE3GPPCAUSE_11 = 6 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 3 AND ERABSETUPFAILURE3GPPCAUSE_12 = 6 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 3 AND ERABSETUPFAILURE3GPPCAUSE_13 = 6 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 3 AND ERABSETUPFAILURE3GPPCAUSE_14 = 6 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 3 AND ERABSETUPFAILURE3GPPCAUSE_15 = 6 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

--CpmErabEstabFailInitRnlS1Cause$

Update EVENT_4106 set CpmErabEstabFailInitRnlS1Cause0 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 0  and ERABSETUPFAILURE3GPPCAUSE = 0 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 0 and ERABSETUPFAILURE3GPPCAUSE_1 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 0 and ERABSETUPFAILURE3GPPCAUSE_2 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 0 and ERABSETUPFAILURE3GPPCAUSE_3 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 0 and ERABSETUPFAILURE3GPPCAUSE_4 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 0 and ERABSETUPFAILURE3GPPCAUSE_5 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 0 and ERABSETUPFAILURE3GPPCAUSE_6 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 0 and ERABSETUPFAILURE3GPPCAUSE_7 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 0 and ERABSETUPFAILURE3GPPCAUSE_8 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 0 and ERABSETUPFAILURE3GPPCAUSE_9 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 0 and ERABSETUPFAILURE3GPPCAUSE_10 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 0 and ERABSETUPFAILURE3GPPCAUSE_11 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 0 and ERABSETUPFAILURE3GPPCAUSE_12 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 0 and ERABSETUPFAILURE3GPPCAUSE_13 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 0 and ERABSETUPFAILURE3GPPCAUSE_14 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 0 and ERABSETUPFAILURE3GPPCAUSE_15 = 0 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitRnlS1Cause1 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 0  and ERABSETUPFAILURE3GPPCAUSE = 1 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 0 and ERABSETUPFAILURE3GPPCAUSE_1 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 0 and ERABSETUPFAILURE3GPPCAUSE_2 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 0 and ERABSETUPFAILURE3GPPCAUSE_3 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 0 and ERABSETUPFAILURE3GPPCAUSE_4 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 0 and ERABSETUPFAILURE3GPPCAUSE_5 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 0 and ERABSETUPFAILURE3GPPCAUSE_6 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 0 and ERABSETUPFAILURE3GPPCAUSE_7 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 0 and ERABSETUPFAILURE3GPPCAUSE_8 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 0 and ERABSETUPFAILURE3GPPCAUSE_9 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 0 and ERABSETUPFAILURE3GPPCAUSE_10 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 0 and ERABSETUPFAILURE3GPPCAUSE_11 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 0 and ERABSETUPFAILURE3GPPCAUSE_12 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 0 and ERABSETUPFAILURE3GPPCAUSE_13 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 0 and ERABSETUPFAILURE3GPPCAUSE_14 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 0 and ERABSETUPFAILURE3GPPCAUSE_15 = 1 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitRnlS1Cause2 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 0  and ERABSETUPFAILURE3GPPCAUSE = 2 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 0 and ERABSETUPFAILURE3GPPCAUSE_1 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 0 and ERABSETUPFAILURE3GPPCAUSE_2 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 0 and ERABSETUPFAILURE3GPPCAUSE_3 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 0 and ERABSETUPFAILURE3GPPCAUSE_4 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 0 and ERABSETUPFAILURE3GPPCAUSE_5 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 0 and ERABSETUPFAILURE3GPPCAUSE_6 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 0 and ERABSETUPFAILURE3GPPCAUSE_7 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 0 and ERABSETUPFAILURE3GPPCAUSE_8 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 0 and ERABSETUPFAILURE3GPPCAUSE_9 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 0 and ERABSETUPFAILURE3GPPCAUSE_10 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 0 and ERABSETUPFAILURE3GPPCAUSE_11 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 0 and ERABSETUPFAILURE3GPPCAUSE_12 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 0 and ERABSETUPFAILURE3GPPCAUSE_13 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 0 and ERABSETUPFAILURE3GPPCAUSE_14 = 2 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 0 and ERABSETUPFAILURE3GPPCAUSE_15 = 2 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitRnlS1Cause3 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 0  and ERABSETUPFAILURE3GPPCAUSE = 3 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 0 and ERABSETUPFAILURE3GPPCAUSE_1 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 0 and ERABSETUPFAILURE3GPPCAUSE_2 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 0 and ERABSETUPFAILURE3GPPCAUSE_3 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 0 and ERABSETUPFAILURE3GPPCAUSE_4 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 0 and ERABSETUPFAILURE3GPPCAUSE_5 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 0 and ERABSETUPFAILURE3GPPCAUSE_6 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 0 and ERABSETUPFAILURE3GPPCAUSE_7 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 0 and ERABSETUPFAILURE3GPPCAUSE_8 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 0 and ERABSETUPFAILURE3GPPCAUSE_9 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 0 and ERABSETUPFAILURE3GPPCAUSE_10 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 0 and ERABSETUPFAILURE3GPPCAUSE_11 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 0 and ERABSETUPFAILURE3GPPCAUSE_12 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 0 and ERABSETUPFAILURE3GPPCAUSE_13 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 0 and ERABSETUPFAILURE3GPPCAUSE_14 = 3 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 0 and ERABSETUPFAILURE3GPPCAUSE_15 = 3 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitRnlS1Cause4 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 0  and ERABSETUPFAILURE3GPPCAUSE = 4 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 0 and ERABSETUPFAILURE3GPPCAUSE_1 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 0 and ERABSETUPFAILURE3GPPCAUSE_2 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 0 and ERABSETUPFAILURE3GPPCAUSE_3 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 0 and ERABSETUPFAILURE3GPPCAUSE_4 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 0 and ERABSETUPFAILURE3GPPCAUSE_5 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 0 and ERABSETUPFAILURE3GPPCAUSE_6 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 0 and ERABSETUPFAILURE3GPPCAUSE_7 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 0 and ERABSETUPFAILURE3GPPCAUSE_8 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 0 and ERABSETUPFAILURE3GPPCAUSE_9 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 0 and ERABSETUPFAILURE3GPPCAUSE_10 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 0 and ERABSETUPFAILURE3GPPCAUSE_11 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 0 and ERABSETUPFAILURE3GPPCAUSE_12 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 0 and ERABSETUPFAILURE3GPPCAUSE_13 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 0 and ERABSETUPFAILURE3GPPCAUSE_14 = 4 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 0 and ERABSETUPFAILURE3GPPCAUSE_15 = 4 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitRnlS1Cause5 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 0  and ERABSETUPFAILURE3GPPCAUSE = 5 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 0 and ERABSETUPFAILURE3GPPCAUSE_1 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 0 and ERABSETUPFAILURE3GPPCAUSE_2 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 0 and ERABSETUPFAILURE3GPPCAUSE_3 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 0 and ERABSETUPFAILURE3GPPCAUSE_4 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 0 and ERABSETUPFAILURE3GPPCAUSE_5 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 0 and ERABSETUPFAILURE3GPPCAUSE_6 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 0 and ERABSETUPFAILURE3GPPCAUSE_7 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 0 and ERABSETUPFAILURE3GPPCAUSE_8 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 0 and ERABSETUPFAILURE3GPPCAUSE_9 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 0 and ERABSETUPFAILURE3GPPCAUSE_10 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 0 and ERABSETUPFAILURE3GPPCAUSE_11 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 0 and ERABSETUPFAILURE3GPPCAUSE_12 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 0 and ERABSETUPFAILURE3GPPCAUSE_13 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 0 and ERABSETUPFAILURE3GPPCAUSE_14 = 5 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 0 and ERABSETUPFAILURE3GPPCAUSE_15 = 5 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitRnlS1Cause6 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 0  and ERABSETUPFAILURE3GPPCAUSE = 6 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 0 and ERABSETUPFAILURE3GPPCAUSE_1 = 6 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 0 and ERABSETUPFAILURE3GPPCAUSE_2 = 6 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 0 and ERABSETUPFAILURE3GPPCAUSE_3 = 6 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 0 and ERABSETUPFAILURE3GPPCAUSE_4 = 6 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 0 and ERABSETUPFAILURE3GPPCAUSE_5 = 6 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 0 and ERABSETUPFAILURE3GPPCAUSE_6 = 6 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 0 and ERABSETUPFAILURE3GPPCAUSE_7 = 6 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 0 and ERABSETUPFAILURE3GPPCAUSE_8 = 6 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 0 and ERABSETUPFAILURE3GPPCAUSE_9 = 6 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 0 and ERABSETUPFAILURE3GPPCAUSE_10 = 6 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 0 and ERABSETUPFAILURE3GPPCAUSE_11 = 6 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 0 and ERABSETUPFAILURE3GPPCAUSE_12 = 6 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 0 and ERABSETUPFAILURE3GPPCAUSE_13 = 6 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 0 and ERABSETUPFAILURE3GPPCAUSE_14 = 6 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 0 and ERABSETUPFAILURE3GPPCAUSE_15 = 6 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitRnlS1Cause7 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 0  and ERABSETUPFAILURE3GPPCAUSE = 7 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 0 and ERABSETUPFAILURE3GPPCAUSE_1 = 7 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 0 and ERABSETUPFAILURE3GPPCAUSE_2 = 7 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 0 and ERABSETUPFAILURE3GPPCAUSE_3 = 7 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 0 and ERABSETUPFAILURE3GPPCAUSE_4 = 7 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 0 and ERABSETUPFAILURE3GPPCAUSE_5 = 7 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 0 and ERABSETUPFAILURE3GPPCAUSE_6 = 7 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 0 and ERABSETUPFAILURE3GPPCAUSE_7 = 7 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 0 and ERABSETUPFAILURE3GPPCAUSE_8 = 7 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 0 and ERABSETUPFAILURE3GPPCAUSE_9 = 7 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 0 and ERABSETUPFAILURE3GPPCAUSE_10 = 7 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 0 and ERABSETUPFAILURE3GPPCAUSE_11 = 7 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 0 and ERABSETUPFAILURE3GPPCAUSE_12 = 7 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 0 and ERABSETUPFAILURE3GPPCAUSE_13 = 7 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 0 and ERABSETUPFAILURE3GPPCAUSE_14 = 7 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 0 and ERABSETUPFAILURE3GPPCAUSE_15 = 7 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitRnlS1Cause8 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 0  and ERABSETUPFAILURE3GPPCAUSE = 8 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 0 and ERABSETUPFAILURE3GPPCAUSE_1 = 8 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 0 and ERABSETUPFAILURE3GPPCAUSE_2 = 8 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 0 and ERABSETUPFAILURE3GPPCAUSE_3 = 8 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 0 and ERABSETUPFAILURE3GPPCAUSE_4 = 8 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 0 and ERABSETUPFAILURE3GPPCAUSE_5 = 8 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 0 and ERABSETUPFAILURE3GPPCAUSE_6 = 8 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 0 and ERABSETUPFAILURE3GPPCAUSE_7 = 8 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 0 and ERABSETUPFAILURE3GPPCAUSE_8 = 8 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 0 and ERABSETUPFAILURE3GPPCAUSE_9 = 8 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 0 and ERABSETUPFAILURE3GPPCAUSE_10 = 8 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 0 and ERABSETUPFAILURE3GPPCAUSE_11 = 8 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 0 and ERABSETUPFAILURE3GPPCAUSE_12 = 8 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 0 and ERABSETUPFAILURE3GPPCAUSE_13 = 8 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 0 and ERABSETUPFAILURE3GPPCAUSE_14 = 8 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 0 and ERABSETUPFAILURE3GPPCAUSE_15 = 8 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitRnlS1Cause9 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 0  and ERABSETUPFAILURE3GPPCAUSE = 9 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 0 and ERABSETUPFAILURE3GPPCAUSE_1 = 9 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 0 and ERABSETUPFAILURE3GPPCAUSE_2 = 9 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 0 and ERABSETUPFAILURE3GPPCAUSE_3 = 9 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 0 and ERABSETUPFAILURE3GPPCAUSE_4 = 9 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 0 and ERABSETUPFAILURE3GPPCAUSE_5 = 9 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 0 and ERABSETUPFAILURE3GPPCAUSE_6 = 9 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 0 and ERABSETUPFAILURE3GPPCAUSE_7 = 9 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 0 and ERABSETUPFAILURE3GPPCAUSE_8 = 9 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 0 and ERABSETUPFAILURE3GPPCAUSE_9 = 9 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 0 and ERABSETUPFAILURE3GPPCAUSE_10 = 9 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 0 and ERABSETUPFAILURE3GPPCAUSE_11 = 9 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 0 and ERABSETUPFAILURE3GPPCAUSE_12 = 9 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 0 and ERABSETUPFAILURE3GPPCAUSE_13 = 9 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 0 and ERABSETUPFAILURE3GPPCAUSE_14 = 9 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 0 and ERABSETUPFAILURE3GPPCAUSE_15 = 9 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitRnlS1Cause10 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 0  and ERABSETUPFAILURE3GPPCAUSE = 10 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 0 and ERABSETUPFAILURE3GPPCAUSE_1 = 10 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 0 and ERABSETUPFAILURE3GPPCAUSE_2 = 10 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 0 and ERABSETUPFAILURE3GPPCAUSE_3 = 10 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 0 and ERABSETUPFAILURE3GPPCAUSE_4 = 10 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 0 and ERABSETUPFAILURE3GPPCAUSE_5 = 10 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 0 and ERABSETUPFAILURE3GPPCAUSE_6 = 10 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 0 and ERABSETUPFAILURE3GPPCAUSE_7 = 10 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 0 and ERABSETUPFAILURE3GPPCAUSE_8 = 10 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 0 and ERABSETUPFAILURE3GPPCAUSE_9 = 10 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 0 and ERABSETUPFAILURE3GPPCAUSE_10 = 10 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 0 and ERABSETUPFAILURE3GPPCAUSE_11 = 10 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 0 and ERABSETUPFAILURE3GPPCAUSE_12 = 10 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 0 and ERABSETUPFAILURE3GPPCAUSE_13 = 10 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 0 and ERABSETUPFAILURE3GPPCAUSE_14 = 10 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 0 and ERABSETUPFAILURE3GPPCAUSE_15 = 10 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitRnlS1Cause11 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 0  and ERABSETUPFAILURE3GPPCAUSE = 11 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 0 and ERABSETUPFAILURE3GPPCAUSE_1 = 11 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 0 and ERABSETUPFAILURE3GPPCAUSE_2 = 11 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 0 and ERABSETUPFAILURE3GPPCAUSE_3 = 11 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 0 and ERABSETUPFAILURE3GPPCAUSE_4 = 11 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 0 and ERABSETUPFAILURE3GPPCAUSE_5 = 11 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 0 and ERABSETUPFAILURE3GPPCAUSE_6 = 11 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 0 and ERABSETUPFAILURE3GPPCAUSE_7 = 11 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 0 and ERABSETUPFAILURE3GPPCAUSE_8 = 11 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 0 and ERABSETUPFAILURE3GPPCAUSE_9 = 11 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 0 and ERABSETUPFAILURE3GPPCAUSE_10 = 11 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 0 and ERABSETUPFAILURE3GPPCAUSE_11 = 11 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 0 and ERABSETUPFAILURE3GPPCAUSE_12 = 11 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 0 and ERABSETUPFAILURE3GPPCAUSE_13 = 11 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 0 and ERABSETUPFAILURE3GPPCAUSE_14 = 11 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 0 and ERABSETUPFAILURE3GPPCAUSE_15 = 11 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitRnlS1Cause12 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 0  and ERABSETUPFAILURE3GPPCAUSE = 12 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 0 and ERABSETUPFAILURE3GPPCAUSE_1 = 12 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 0 and ERABSETUPFAILURE3GPPCAUSE_2 = 12 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 0 and ERABSETUPFAILURE3GPPCAUSE_3 = 12 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 0 and ERABSETUPFAILURE3GPPCAUSE_4 = 12 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 0 and ERABSETUPFAILURE3GPPCAUSE_5 = 12 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 0 and ERABSETUPFAILURE3GPPCAUSE_6 = 12 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 0 and ERABSETUPFAILURE3GPPCAUSE_7 = 12 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 0 and ERABSETUPFAILURE3GPPCAUSE_8 = 12 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 0 and ERABSETUPFAILURE3GPPCAUSE_9 = 12 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 0 and ERABSETUPFAILURE3GPPCAUSE_10 = 12 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 0 and ERABSETUPFAILURE3GPPCAUSE_11 = 12 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 0 and ERABSETUPFAILURE3GPPCAUSE_12 = 12 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 0 and ERABSETUPFAILURE3GPPCAUSE_13 = 12 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 0 and ERABSETUPFAILURE3GPPCAUSE_14 = 12 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 0 and ERABSETUPFAILURE3GPPCAUSE_15 = 12 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitRnlS1Cause13 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 0  and ERABSETUPFAILURE3GPPCAUSE = 13 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 0 and ERABSETUPFAILURE3GPPCAUSE_1 = 13 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 0 and ERABSETUPFAILURE3GPPCAUSE_2 = 13 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 0 and ERABSETUPFAILURE3GPPCAUSE_3 = 13 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 0 and ERABSETUPFAILURE3GPPCAUSE_4 = 13 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 0 and ERABSETUPFAILURE3GPPCAUSE_5 = 13 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 0 and ERABSETUPFAILURE3GPPCAUSE_6 = 13 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 0 and ERABSETUPFAILURE3GPPCAUSE_7 = 13 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 0 and ERABSETUPFAILURE3GPPCAUSE_8 = 13 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 0 and ERABSETUPFAILURE3GPPCAUSE_9 = 13 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 0 and ERABSETUPFAILURE3GPPCAUSE_10 = 13 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 0 and ERABSETUPFAILURE3GPPCAUSE_11 = 13 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 0 and ERABSETUPFAILURE3GPPCAUSE_12 = 13 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 0 and ERABSETUPFAILURE3GPPCAUSE_13 = 13 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 0 and ERABSETUPFAILURE3GPPCAUSE_14 = 13 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 0 and ERABSETUPFAILURE3GPPCAUSE_15 = 13 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitRnlS1Cause14 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 0  and ERABSETUPFAILURE3GPPCAUSE = 14 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 0 and ERABSETUPFAILURE3GPPCAUSE_1 = 14 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 0 and ERABSETUPFAILURE3GPPCAUSE_2 = 14 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 0 and ERABSETUPFAILURE3GPPCAUSE_3 = 14 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 0 and ERABSETUPFAILURE3GPPCAUSE_4 = 14 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 0 and ERABSETUPFAILURE3GPPCAUSE_5 = 14 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 0 and ERABSETUPFAILURE3GPPCAUSE_6 = 14 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 0 and ERABSETUPFAILURE3GPPCAUSE_7 = 14 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 0 and ERABSETUPFAILURE3GPPCAUSE_8 = 14 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 0 and ERABSETUPFAILURE3GPPCAUSE_9 = 14 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 0 and ERABSETUPFAILURE3GPPCAUSE_10 = 14 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 0 and ERABSETUPFAILURE3GPPCAUSE_11 = 14 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 0 and ERABSETUPFAILURE3GPPCAUSE_12 = 14 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 0 and ERABSETUPFAILURE3GPPCAUSE_13 = 14 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 0 and ERABSETUPFAILURE3GPPCAUSE_14 = 14 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 0 and ERABSETUPFAILURE3GPPCAUSE_15 = 14 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitRnlS1Cause15 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 0  and ERABSETUPFAILURE3GPPCAUSE = 15 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 0 and ERABSETUPFAILURE3GPPCAUSE_1 = 15 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 0 and ERABSETUPFAILURE3GPPCAUSE_2 = 15 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 0 and ERABSETUPFAILURE3GPPCAUSE_3 = 15 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 0 and ERABSETUPFAILURE3GPPCAUSE_4 = 15 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 0 and ERABSETUPFAILURE3GPPCAUSE_5 = 15 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 0 and ERABSETUPFAILURE3GPPCAUSE_6 = 15 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 0 and ERABSETUPFAILURE3GPPCAUSE_7 = 15 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 0 and ERABSETUPFAILURE3GPPCAUSE_8 = 15 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 0 and ERABSETUPFAILURE3GPPCAUSE_9 = 15 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 0 and ERABSETUPFAILURE3GPPCAUSE_10 = 15 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 0 and ERABSETUPFAILURE3GPPCAUSE_11 = 15 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 0 and ERABSETUPFAILURE3GPPCAUSE_12 = 15 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 0 and ERABSETUPFAILURE3GPPCAUSE_13 = 15 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 0 and ERABSETUPFAILURE3GPPCAUSE_14 = 15 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 0 and ERABSETUPFAILURE3GPPCAUSE_15 = 15 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitRnlS1Cause16 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 0  and ERABSETUPFAILURE3GPPCAUSE = 16 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 0 and ERABSETUPFAILURE3GPPCAUSE_1 = 16 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 0 and ERABSETUPFAILURE3GPPCAUSE_2 = 16 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 0 and ERABSETUPFAILURE3GPPCAUSE_3 = 16 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 0 and ERABSETUPFAILURE3GPPCAUSE_4 = 16 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 0 and ERABSETUPFAILURE3GPPCAUSE_5 = 16 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 0 and ERABSETUPFAILURE3GPPCAUSE_6 = 16 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 0 and ERABSETUPFAILURE3GPPCAUSE_7 = 16 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 0 and ERABSETUPFAILURE3GPPCAUSE_8 = 16 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 0 and ERABSETUPFAILURE3GPPCAUSE_9 = 16 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 0 and ERABSETUPFAILURE3GPPCAUSE_10 = 16 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 0 and ERABSETUPFAILURE3GPPCAUSE_11 = 16 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 0 and ERABSETUPFAILURE3GPPCAUSE_12 = 16 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 0 and ERABSETUPFAILURE3GPPCAUSE_13 = 16 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 0 and ERABSETUPFAILURE3GPPCAUSE_14 = 16 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 0 and ERABSETUPFAILURE3GPPCAUSE_15 = 16 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitRnlS1Cause17 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 0  and ERABSETUPFAILURE3GPPCAUSE = 17 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 0 and ERABSETUPFAILURE3GPPCAUSE_1 = 17 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 0 and ERABSETUPFAILURE3GPPCAUSE_2 = 17 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 0 and ERABSETUPFAILURE3GPPCAUSE_3 = 17 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 0 and ERABSETUPFAILURE3GPPCAUSE_4 = 17 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 0 and ERABSETUPFAILURE3GPPCAUSE_5 = 17 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 0 and ERABSETUPFAILURE3GPPCAUSE_6 = 17 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 0 and ERABSETUPFAILURE3GPPCAUSE_7 = 17 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 0 and ERABSETUPFAILURE3GPPCAUSE_8 = 17 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 0 and ERABSETUPFAILURE3GPPCAUSE_9 = 17 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 0 and ERABSETUPFAILURE3GPPCAUSE_10 = 17 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 0 and ERABSETUPFAILURE3GPPCAUSE_11 = 17 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 0 and ERABSETUPFAILURE3GPPCAUSE_12 = 17 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 0 and ERABSETUPFAILURE3GPPCAUSE_13 = 17 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 0 and ERABSETUPFAILURE3GPPCAUSE_14 = 17 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 0 and ERABSETUPFAILURE3GPPCAUSE_15 = 17 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitRnlS1Cause18 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 0  and ERABSETUPFAILURE3GPPCAUSE = 18 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 0 and ERABSETUPFAILURE3GPPCAUSE_1 = 18 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 0 and ERABSETUPFAILURE3GPPCAUSE_2 = 18 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 0 and ERABSETUPFAILURE3GPPCAUSE_3 = 18 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 0 and ERABSETUPFAILURE3GPPCAUSE_4 = 18 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 0 and ERABSETUPFAILURE3GPPCAUSE_5 = 18 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 0 and ERABSETUPFAILURE3GPPCAUSE_6 = 18 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 0 and ERABSETUPFAILURE3GPPCAUSE_7 = 18 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 0 and ERABSETUPFAILURE3GPPCAUSE_8 = 18 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 0 and ERABSETUPFAILURE3GPPCAUSE_9 = 18 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 0 and ERABSETUPFAILURE3GPPCAUSE_10 = 18 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 0 and ERABSETUPFAILURE3GPPCAUSE_11 = 18 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 0 and ERABSETUPFAILURE3GPPCAUSE_12 = 18 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 0 and ERABSETUPFAILURE3GPPCAUSE_13 = 18 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 0 and ERABSETUPFAILURE3GPPCAUSE_14 = 18 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 0 and ERABSETUPFAILURE3GPPCAUSE_15 = 18 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitRnlS1Cause19 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 0  and ERABSETUPFAILURE3GPPCAUSE = 19 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 0 and ERABSETUPFAILURE3GPPCAUSE_1 = 19 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 0 and ERABSETUPFAILURE3GPPCAUSE_2 = 19 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 0 and ERABSETUPFAILURE3GPPCAUSE_3 = 19 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 0 and ERABSETUPFAILURE3GPPCAUSE_4 = 19 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 0 and ERABSETUPFAILURE3GPPCAUSE_5 = 19 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 0 and ERABSETUPFAILURE3GPPCAUSE_6 = 19 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 0 and ERABSETUPFAILURE3GPPCAUSE_7 = 19 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 0 and ERABSETUPFAILURE3GPPCAUSE_8 = 19 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 0 and ERABSETUPFAILURE3GPPCAUSE_9 = 19 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 0 and ERABSETUPFAILURE3GPPCAUSE_10 = 19 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 0 and ERABSETUPFAILURE3GPPCAUSE_11 = 19 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 0 and ERABSETUPFAILURE3GPPCAUSE_12 = 19 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 0 and ERABSETUPFAILURE3GPPCAUSE_13 = 19 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 0 and ERABSETUPFAILURE3GPPCAUSE_14 = 19 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 0 and ERABSETUPFAILURE3GPPCAUSE_15 = 19 then 1 else 0 end) from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitRnlS1Cause20 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 0  and ERABSETUPFAILURE3GPPCAUSE = 20 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 0 and ERABSETUPFAILURE3GPPCAUSE_1 = 20 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 0 and ERABSETUPFAILURE3GPPCAUSE_2 = 20 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 0 and ERABSETUPFAILURE3GPPCAUSE_3 = 20 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 0 and ERABSETUPFAILURE3GPPCAUSE_4 = 20 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 0 and ERABSETUPFAILURE3GPPCAUSE_5 = 20 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 0 and ERABSETUPFAILURE3GPPCAUSE_6 = 20 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 0 and ERABSETUPFAILURE3GPPCAUSE_7 = 20 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 0 and ERABSETUPFAILURE3GPPCAUSE_8 = 20 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 0 and ERABSETUPFAILURE3GPPCAUSE_9 = 20 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 0 and ERABSETUPFAILURE3GPPCAUSE_10 = 20 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 0 and ERABSETUPFAILURE3GPPCAUSE_11 = 20 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 0 and ERABSETUPFAILURE3GPPCAUSE_12 = 20 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 0 and ERABSETUPFAILURE3GPPCAUSE_13 = 20 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 0 and ERABSETUPFAILURE3GPPCAUSE_14 = 20 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 0 and ERABSETUPFAILURE3GPPCAUSE_15 = 20 then 1 else 0 end) from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitRnlS1Cause21 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 0  and ERABSETUPFAILURE3GPPCAUSE = 21 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 0 and ERABSETUPFAILURE3GPPCAUSE_1 = 21 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 0 and ERABSETUPFAILURE3GPPCAUSE_2 = 21 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 0 and ERABSETUPFAILURE3GPPCAUSE_3 = 21 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 0 and ERABSETUPFAILURE3GPPCAUSE_4 = 21 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 0 and ERABSETUPFAILURE3GPPCAUSE_5 = 21 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 0 and ERABSETUPFAILURE3GPPCAUSE_6 = 21 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 0 and ERABSETUPFAILURE3GPPCAUSE_7 = 21 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 0 and ERABSETUPFAILURE3GPPCAUSE_8 = 21 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 0 and ERABSETUPFAILURE3GPPCAUSE_9 = 21 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 0 and ERABSETUPFAILURE3GPPCAUSE_10 = 21 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 0 and ERABSETUPFAILURE3GPPCAUSE_11 = 21 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 0 and ERABSETUPFAILURE3GPPCAUSE_12 = 21 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 0 and ERABSETUPFAILURE3GPPCAUSE_13 = 21 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 0 and ERABSETUPFAILURE3GPPCAUSE_14 = 21 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 0 and ERABSETUPFAILURE3GPPCAUSE_15 = 21 then 1 else 0 end) from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;


Update EVENT_4106 set CpmErabEstabFailInitRnlS1Cause22 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 0  and ERABSETUPFAILURE3GPPCAUSE = 22 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 0 and ERABSETUPFAILURE3GPPCAUSE_1 = 22 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 0 and ERABSETUPFAILURE3GPPCAUSE_2 = 22 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 0 and ERABSETUPFAILURE3GPPCAUSE_3 = 22 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 0 and ERABSETUPFAILURE3GPPCAUSE_4 = 22 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 0 and ERABSETUPFAILURE3GPPCAUSE_5 = 22 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 0 and ERABSETUPFAILURE3GPPCAUSE_6 = 22 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 0 and ERABSETUPFAILURE3GPPCAUSE_7 = 22 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 0 and ERABSETUPFAILURE3GPPCAUSE_8 = 22 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 0 and ERABSETUPFAILURE3GPPCAUSE_9 = 22 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 0 and ERABSETUPFAILURE3GPPCAUSE_10 = 22 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 0 and ERABSETUPFAILURE3GPPCAUSE_11 = 22 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 0 and ERABSETUPFAILURE3GPPCAUSE_12 = 22 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 0 and ERABSETUPFAILURE3GPPCAUSE_13 = 22 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 0 and ERABSETUPFAILURE3GPPCAUSE_14 = 22 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 0 and ERABSETUPFAILURE3GPPCAUSE_15 = 22 then 1 else 0 end) from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitRnlS1Cause23 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 0  and ERABSETUPFAILURE3GPPCAUSE = 23 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 0 and ERABSETUPFAILURE3GPPCAUSE_1 = 23 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 0 and ERABSETUPFAILURE3GPPCAUSE_2 = 23 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 0 and ERABSETUPFAILURE3GPPCAUSE_3 = 23 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 0 and ERABSETUPFAILURE3GPPCAUSE_4 = 23 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 0 and ERABSETUPFAILURE3GPPCAUSE_5 = 23 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 0 and ERABSETUPFAILURE3GPPCAUSE_6 = 23 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 0 and ERABSETUPFAILURE3GPPCAUSE_7 = 23 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 0 and ERABSETUPFAILURE3GPPCAUSE_8 = 23 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 0 and ERABSETUPFAILURE3GPPCAUSE_9 = 23 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 0 and ERABSETUPFAILURE3GPPCAUSE_10 = 23 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 0 and ERABSETUPFAILURE3GPPCAUSE_11 = 23 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 0 and ERABSETUPFAILURE3GPPCAUSE_12 = 23 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 0 and ERABSETUPFAILURE3GPPCAUSE_13 = 23 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 0 and ERABSETUPFAILURE3GPPCAUSE_14 = 23 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 0 and ERABSETUPFAILURE3GPPCAUSE_15 = 23 then 1 else 0 end) from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitRnlS1Cause24 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 0  and ERABSETUPFAILURE3GPPCAUSE = 24 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 0 and ERABSETUPFAILURE3GPPCAUSE_1 = 24 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 0 and ERABSETUPFAILURE3GPPCAUSE_2 = 24 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 0 and ERABSETUPFAILURE3GPPCAUSE_3 = 24 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 0 and ERABSETUPFAILURE3GPPCAUSE_4 = 24 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 0 and ERABSETUPFAILURE3GPPCAUSE_5 = 24 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 0 and ERABSETUPFAILURE3GPPCAUSE_6 = 24 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 0 and ERABSETUPFAILURE3GPPCAUSE_7 = 24 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 0 and ERABSETUPFAILURE3GPPCAUSE_8 = 24 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 0 and ERABSETUPFAILURE3GPPCAUSE_9 = 24 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 0 and ERABSETUPFAILURE3GPPCAUSE_10 = 24 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 0 and ERABSETUPFAILURE3GPPCAUSE_11 = 24 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 0 and ERABSETUPFAILURE3GPPCAUSE_12 = 24 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 0 and ERABSETUPFAILURE3GPPCAUSE_13 = 24 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 0 and ERABSETUPFAILURE3GPPCAUSE_14 = 24 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 0 and ERABSETUPFAILURE3GPPCAUSE_15 = 24 then 1 else 0 end) from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitRnlS1Cause25 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 0  and ERABSETUPFAILURE3GPPCAUSE = 25 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 0 and ERABSETUPFAILURE3GPPCAUSE_1 = 25 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 0 and ERABSETUPFAILURE3GPPCAUSE_2 = 25 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 0 and ERABSETUPFAILURE3GPPCAUSE_3 = 25 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 0 and ERABSETUPFAILURE3GPPCAUSE_4 = 25 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 0 and ERABSETUPFAILURE3GPPCAUSE_5 = 25 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 0 and ERABSETUPFAILURE3GPPCAUSE_6 = 25 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 0 and ERABSETUPFAILURE3GPPCAUSE_7 = 25 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 0 and ERABSETUPFAILURE3GPPCAUSE_8 = 25 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 0 and ERABSETUPFAILURE3GPPCAUSE_9 = 25 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 0 and ERABSETUPFAILURE3GPPCAUSE_10 = 25 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 0 and ERABSETUPFAILURE3GPPCAUSE_11 = 25 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 0 and ERABSETUPFAILURE3GPPCAUSE_12 = 25 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 0 and ERABSETUPFAILURE3GPPCAUSE_13 = 25 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 0 and ERABSETUPFAILURE3GPPCAUSE_14 = 25 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 0 and ERABSETUPFAILURE3GPPCAUSE_15 = 25 then 1 else 0 end) from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitRnlS1Cause26 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 0  and ERABSETUPFAILURE3GPPCAUSE = 26 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 0 and ERABSETUPFAILURE3GPPCAUSE_1 = 26 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 0 and ERABSETUPFAILURE3GPPCAUSE_2 = 26 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 0 and ERABSETUPFAILURE3GPPCAUSE_3 = 26 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 0 and ERABSETUPFAILURE3GPPCAUSE_4 = 26 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 0 and ERABSETUPFAILURE3GPPCAUSE_5 = 26 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 0 and ERABSETUPFAILURE3GPPCAUSE_6 = 26 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 0 and ERABSETUPFAILURE3GPPCAUSE_7 = 26 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 0 and ERABSETUPFAILURE3GPPCAUSE_8 = 26 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 0 and ERABSETUPFAILURE3GPPCAUSE_9 = 26 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 0 and ERABSETUPFAILURE3GPPCAUSE_10 = 26 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 0 and ERABSETUPFAILURE3GPPCAUSE_11 = 26 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 0 and ERABSETUPFAILURE3GPPCAUSE_12 = 26 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 0 and ERABSETUPFAILURE3GPPCAUSE_13 = 26 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 0 and ERABSETUPFAILURE3GPPCAUSE_14 = 26 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 0 and ERABSETUPFAILURE3GPPCAUSE_15 = 26 then 1 else 0 end) from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitRnlS1Cause27 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 0  and ERABSETUPFAILURE3GPPCAUSE = 27 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 0 and ERABSETUPFAILURE3GPPCAUSE_1 = 27 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 0 and ERABSETUPFAILURE3GPPCAUSE_2 = 27 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 0 and ERABSETUPFAILURE3GPPCAUSE_3 = 27 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 0 and ERABSETUPFAILURE3GPPCAUSE_4 = 27 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 0 and ERABSETUPFAILURE3GPPCAUSE_5 = 27 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 0 and ERABSETUPFAILURE3GPPCAUSE_6 = 27 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 0 and ERABSETUPFAILURE3GPPCAUSE_7 = 27 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 0 and ERABSETUPFAILURE3GPPCAUSE_8 = 27 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 0 and ERABSETUPFAILURE3GPPCAUSE_9 = 27 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 0 and ERABSETUPFAILURE3GPPCAUSE_10 = 27 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 0 and ERABSETUPFAILURE3GPPCAUSE_11 = 27 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 0 and ERABSETUPFAILURE3GPPCAUSE_12 = 27 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 0 and ERABSETUPFAILURE3GPPCAUSE_13 = 27 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 0 and ERABSETUPFAILURE3GPPCAUSE_14 = 27 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 0 and ERABSETUPFAILURE3GPPCAUSE_15 = 27 then 1 else 0 end) from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitRnlS1Cause28 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 0  and ERABSETUPFAILURE3GPPCAUSE = 28 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 0 and ERABSETUPFAILURE3GPPCAUSE_1 = 28 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 0 and ERABSETUPFAILURE3GPPCAUSE_2 = 28 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 0 and ERABSETUPFAILURE3GPPCAUSE_3 = 28 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 0 and ERABSETUPFAILURE3GPPCAUSE_4 = 28 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 0 and ERABSETUPFAILURE3GPPCAUSE_5 = 28 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 0 and ERABSETUPFAILURE3GPPCAUSE_6 = 28 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 0 and ERABSETUPFAILURE3GPPCAUSE_7 = 28 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 0 and ERABSETUPFAILURE3GPPCAUSE_8 = 28 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 0 and ERABSETUPFAILURE3GPPCAUSE_9 = 28 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 0 and ERABSETUPFAILURE3GPPCAUSE_10 = 28 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 0 and ERABSETUPFAILURE3GPPCAUSE_11 = 28 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 0 and ERABSETUPFAILURE3GPPCAUSE_12 = 28 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 0 and ERABSETUPFAILURE3GPPCAUSE_13 = 28 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 0 and ERABSETUPFAILURE3GPPCAUSE_14 = 28 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 0 and ERABSETUPFAILURE3GPPCAUSE_15 = 28 then 1 else 0 end) from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitRnlS1Cause29 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 0  and ERABSETUPFAILURE3GPPCAUSE = 29 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 0 and ERABSETUPFAILURE3GPPCAUSE_1 = 29 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 0 and ERABSETUPFAILURE3GPPCAUSE_2 = 29 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 0 and ERABSETUPFAILURE3GPPCAUSE_3 = 29 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 0 and ERABSETUPFAILURE3GPPCAUSE_4 = 29 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 0 and ERABSETUPFAILURE3GPPCAUSE_5 = 29 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 0 and ERABSETUPFAILURE3GPPCAUSE_6 = 29 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 0 and ERABSETUPFAILURE3GPPCAUSE_7 = 29 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 0 and ERABSETUPFAILURE3GPPCAUSE_8 = 29 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 0 and ERABSETUPFAILURE3GPPCAUSE_9 = 29 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 0 and ERABSETUPFAILURE3GPPCAUSE_10 = 29 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 0 and ERABSETUPFAILURE3GPPCAUSE_11 = 29 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 0 and ERABSETUPFAILURE3GPPCAUSE_12 = 29 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 0 and ERABSETUPFAILURE3GPPCAUSE_13 = 29 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 0 and ERABSETUPFAILURE3GPPCAUSE_14 = 29 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 0 and ERABSETUPFAILURE3GPPCAUSE_15 = 29 then 1 else 0 end) from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitRnlS1Cause30 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 0  and ERABSETUPFAILURE3GPPCAUSE = 30 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 0 and ERABSETUPFAILURE3GPPCAUSE_1 = 30 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 0 and ERABSETUPFAILURE3GPPCAUSE_2 = 30 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 0 and ERABSETUPFAILURE3GPPCAUSE_3 = 30 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 0 and ERABSETUPFAILURE3GPPCAUSE_4 = 30 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 0 and ERABSETUPFAILURE3GPPCAUSE_5 = 30 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 0 and ERABSETUPFAILURE3GPPCAUSE_6 = 30 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 0 and ERABSETUPFAILURE3GPPCAUSE_7 = 30 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 0 and ERABSETUPFAILURE3GPPCAUSE_8 = 30 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 0 and ERABSETUPFAILURE3GPPCAUSE_9 = 30 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 0 and ERABSETUPFAILURE3GPPCAUSE_10 = 30 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 0 and ERABSETUPFAILURE3GPPCAUSE_11 = 30 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 0 and ERABSETUPFAILURE3GPPCAUSE_12 = 30 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 0 and ERABSETUPFAILURE3GPPCAUSE_13 = 30 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 0 and ERABSETUPFAILURE3GPPCAUSE_14 = 30 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 0 and ERABSETUPFAILURE3GPPCAUSE_15 = 30 then 1 else 0 end) from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitRnlS1Cause31 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 0  and ERABSETUPFAILURE3GPPCAUSE = 31 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 0 and ERABSETUPFAILURE3GPPCAUSE_1 = 31 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 0 and ERABSETUPFAILURE3GPPCAUSE_2 = 31 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 0 and ERABSETUPFAILURE3GPPCAUSE_3 = 31 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 0 and ERABSETUPFAILURE3GPPCAUSE_4 = 31 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 0 and ERABSETUPFAILURE3GPPCAUSE_5 = 31 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 0 and ERABSETUPFAILURE3GPPCAUSE_6 = 31 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 0 and ERABSETUPFAILURE3GPPCAUSE_7 = 31 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 0 and ERABSETUPFAILURE3GPPCAUSE_8 = 31 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 0 and ERABSETUPFAILURE3GPPCAUSE_9 = 31 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 0 and ERABSETUPFAILURE3GPPCAUSE_10 = 31 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 0 and ERABSETUPFAILURE3GPPCAUSE_11 = 31 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 0 and ERABSETUPFAILURE3GPPCAUSE_12 = 31 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 0 and ERABSETUPFAILURE3GPPCAUSE_13 = 31 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 0 and ERABSETUPFAILURE3GPPCAUSE_14 = 31 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 0 and ERABSETUPFAILURE3GPPCAUSE_15 = 31 then 1 else 0 end) from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitRnlS1Cause32 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 0  and ERABSETUPFAILURE3GPPCAUSE = 32 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 0 and ERABSETUPFAILURE3GPPCAUSE_1 = 32 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 0 and ERABSETUPFAILURE3GPPCAUSE_2 = 32 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 0 and ERABSETUPFAILURE3GPPCAUSE_3 = 32 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 0 and ERABSETUPFAILURE3GPPCAUSE_4 = 32 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 0 and ERABSETUPFAILURE3GPPCAUSE_5 = 32 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 0 and ERABSETUPFAILURE3GPPCAUSE_6 = 32 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 0 and ERABSETUPFAILURE3GPPCAUSE_7 = 32 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 0 and ERABSETUPFAILURE3GPPCAUSE_8 = 32 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 0 and ERABSETUPFAILURE3GPPCAUSE_9 = 32 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 0 and ERABSETUPFAILURE3GPPCAUSE_10 = 32 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 0 and ERABSETUPFAILURE3GPPCAUSE_11 = 32 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 0 and ERABSETUPFAILURE3GPPCAUSE_12 = 32 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 0 and ERABSETUPFAILURE3GPPCAUSE_13 = 32 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 0 and ERABSETUPFAILURE3GPPCAUSE_14 = 32 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 0 and ERABSETUPFAILURE3GPPCAUSE_15 = 32 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitRnlS1Cause33 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 0  and ERABSETUPFAILURE3GPPCAUSE = 33 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 0 and ERABSETUPFAILURE3GPPCAUSE_1 = 33 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 0 and ERABSETUPFAILURE3GPPCAUSE_2 = 33 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 0 and ERABSETUPFAILURE3GPPCAUSE_3 = 33 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 0 and ERABSETUPFAILURE3GPPCAUSE_4 = 33 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 0 and ERABSETUPFAILURE3GPPCAUSE_5 = 33 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 0 and ERABSETUPFAILURE3GPPCAUSE_6 = 33 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 0 and ERABSETUPFAILURE3GPPCAUSE_7 = 33 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 0 and ERABSETUPFAILURE3GPPCAUSE_8 = 33 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 0 and ERABSETUPFAILURE3GPPCAUSE_9 = 33 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 0 and ERABSETUPFAILURE3GPPCAUSE_10 = 33 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 0 and ERABSETUPFAILURE3GPPCAUSE_11 = 33 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 0 and ERABSETUPFAILURE3GPPCAUSE_12 = 33 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 0 and ERABSETUPFAILURE3GPPCAUSE_13 = 33 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 0 and ERABSETUPFAILURE3GPPCAUSE_14 = 33 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 0 and ERABSETUPFAILURE3GPPCAUSE_15 = 33 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitRnlS1Cause34 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 0  and ERABSETUPFAILURE3GPPCAUSE = 34 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 0 and ERABSETUPFAILURE3GPPCAUSE_1 = 34 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 0 and ERABSETUPFAILURE3GPPCAUSE_2 = 34 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 0 and ERABSETUPFAILURE3GPPCAUSE_3 = 34 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 0 and ERABSETUPFAILURE3GPPCAUSE_4 = 34 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 0 and ERABSETUPFAILURE3GPPCAUSE_5 = 34 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 0 and ERABSETUPFAILURE3GPPCAUSE_6 = 34 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 0 and ERABSETUPFAILURE3GPPCAUSE_7 = 34 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 0 and ERABSETUPFAILURE3GPPCAUSE_8 = 34 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 0 and ERABSETUPFAILURE3GPPCAUSE_9 = 34 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 0 and ERABSETUPFAILURE3GPPCAUSE_10 = 34 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 0 and ERABSETUPFAILURE3GPPCAUSE_11 = 34 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 0 and ERABSETUPFAILURE3GPPCAUSE_12 = 34 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 0 and ERABSETUPFAILURE3GPPCAUSE_13 = 34 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 0 and ERABSETUPFAILURE3GPPCAUSE_14 = 34 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 0 and ERABSETUPFAILURE3GPPCAUSE_15 = 34 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitRnlS1Cause35 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 0  and ERABSETUPFAILURE3GPPCAUSE = 35 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 0 and ERABSETUPFAILURE3GPPCAUSE_1 = 35 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 0 and ERABSETUPFAILURE3GPPCAUSE_2 = 35 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 0 and ERABSETUPFAILURE3GPPCAUSE_3 = 35 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 0 and ERABSETUPFAILURE3GPPCAUSE_4 = 35 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 0 and ERABSETUPFAILURE3GPPCAUSE_5 = 35 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 0 and ERABSETUPFAILURE3GPPCAUSE_6 = 35 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 0 and ERABSETUPFAILURE3GPPCAUSE_7 = 35 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 0 and ERABSETUPFAILURE3GPPCAUSE_8 = 35 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 0 and ERABSETUPFAILURE3GPPCAUSE_9 = 35 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 0 and ERABSETUPFAILURE3GPPCAUSE_10 = 35 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 0 and ERABSETUPFAILURE3GPPCAUSE_11 = 35 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 0 and ERABSETUPFAILURE3GPPCAUSE_12 = 35 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 0 and ERABSETUPFAILURE3GPPCAUSE_13 = 35 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 0 and ERABSETUPFAILURE3GPPCAUSE_14 = 35 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 0 and ERABSETUPFAILURE3GPPCAUSE_15 = 35 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitRnlS1Cause36 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 0  and ERABSETUPFAILURE3GPPCAUSE = 36 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 0 and ERABSETUPFAILURE3GPPCAUSE_1 = 36 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 0 and ERABSETUPFAILURE3GPPCAUSE_2 = 36 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 0 and ERABSETUPFAILURE3GPPCAUSE_3 = 36 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 0 and ERABSETUPFAILURE3GPPCAUSE_4 = 36 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 0 and ERABSETUPFAILURE3GPPCAUSE_5 = 36 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 0 and ERABSETUPFAILURE3GPPCAUSE_6 = 36 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 0 and ERABSETUPFAILURE3GPPCAUSE_7 = 36 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 0 and ERABSETUPFAILURE3GPPCAUSE_8 = 36 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 0 and ERABSETUPFAILURE3GPPCAUSE_9 = 36 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 0 and ERABSETUPFAILURE3GPPCAUSE_10 = 36 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 0 and ERABSETUPFAILURE3GPPCAUSE_11 = 36 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 0 and ERABSETUPFAILURE3GPPCAUSE_12 = 36 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 0 and ERABSETUPFAILURE3GPPCAUSE_13 = 36 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 0 and ERABSETUPFAILURE3GPPCAUSE_14 = 36 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 0 and ERABSETUPFAILURE3GPPCAUSE_15 = 36 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitRnlS1Cause37 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 0  and ERABSETUPFAILURE3GPPCAUSE = 37 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 0 and ERABSETUPFAILURE3GPPCAUSE_1 = 37 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 0 and ERABSETUPFAILURE3GPPCAUSE_2 = 37 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 0 and ERABSETUPFAILURE3GPPCAUSE_3 = 37 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 0 and ERABSETUPFAILURE3GPPCAUSE_4 = 37 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 0 and ERABSETUPFAILURE3GPPCAUSE_5 = 37 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 0 and ERABSETUPFAILURE3GPPCAUSE_6 = 37 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 0 and ERABSETUPFAILURE3GPPCAUSE_7 = 37 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 0 and ERABSETUPFAILURE3GPPCAUSE_8 = 37 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 0 and ERABSETUPFAILURE3GPPCAUSE_9 = 37 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 0 and ERABSETUPFAILURE3GPPCAUSE_10 = 37 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 0 and ERABSETUPFAILURE3GPPCAUSE_11 = 37 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 0 and ERABSETUPFAILURE3GPPCAUSE_12 = 37 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 0 and ERABSETUPFAILURE3GPPCAUSE_13 = 37 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 0 and ERABSETUPFAILURE3GPPCAUSE_14 = 37 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 0 and ERABSETUPFAILURE3GPPCAUSE_15 = 37 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabFailInitRnlS1Cause38 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 0  and ERABSETUPFAILURE3GPPCAUSE = 38 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 0 and ERABSETUPFAILURE3GPPCAUSE_1 = 38 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 0 and ERABSETUPFAILURE3GPPCAUSE_2 = 38 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 0 and ERABSETUPFAILURE3GPPCAUSE_3 = 38 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 0 and ERABSETUPFAILURE3GPPCAUSE_4 = 38 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 0 and ERABSETUPFAILURE3GPPCAUSE_5 = 38 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 0 and ERABSETUPFAILURE3GPPCAUSE_6 = 38 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 0 and ERABSETUPFAILURE3GPPCAUSE_7 = 38 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 0 and ERABSETUPFAILURE3GPPCAUSE_8 = 38 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 0 and ERABSETUPFAILURE3GPPCAUSE_9 = 38 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 0 and ERABSETUPFAILURE3GPPCAUSE_10 = 38 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 0 and ERABSETUPFAILURE3GPPCAUSE_11 = 38 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 0 and ERABSETUPFAILURE3GPPCAUSE_12 = 38 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 0 and ERABSETUPFAILURE3GPPCAUSE_13 = 38 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 0 and ERABSETUPFAILURE3GPPCAUSE_14 = 38 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 0 and ERABSETUPFAILURE3GPPCAUSE_15 = 38 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

--CpmErabEstabFailInitTranS1Cause$
Update EVENT_4106 set CpmErabEstabFailInitTranS1Cause0 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 1  AND ERABSETUPFAILURE3GPPCAUSE = 0 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 1and ERABSETUPFAILURE3GPPCAUSE_1 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 1and ERABSETUPFAILURE3GPPCAUSE_2 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 1and ERABSETUPFAILURE3GPPCAUSE_3 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 1and ERABSETUPFAILURE3GPPCAUSE_4 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 1and ERABSETUPFAILURE3GPPCAUSE_5 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 1and ERABSETUPFAILURE3GPPCAUSE_6 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 1and ERABSETUPFAILURE3GPPCAUSE_7 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 1and ERABSETUPFAILURE3GPPCAUSE_8 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 1and ERABSETUPFAILURE3GPPCAUSE_9 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 1 and ERABSETUPFAILURE3GPPCAUSE_10 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 1 and ERABSETUPFAILURE3GPPCAUSE_11 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 1 and ERABSETUPFAILURE3GPPCAUSE_12 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 1 and ERABSETUPFAILURE3GPPCAUSE_13 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 1 and ERABSETUPFAILURE3GPPCAUSE_14 = 0 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 1 and ERABSETUPFAILURE3GPPCAUSE_15 = 0 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;
                                                                                                         
Update EVENT_4106 set CpmErabEstabFailInitTranS1Cause1 = (case when ERABSETUPRESULT != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP = 1  AND ERABSETUPFAILURE3GPPCAUSE = 1 then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_1 = 1 and ERABSETUPFAILURE3GPPCAUSE_1 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_2 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_2 = 1 and ERABSETUPFAILURE3GPPCAUSE_2 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_3 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_3 = 1 and ERABSETUPFAILURE3GPPCAUSE_3 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_4 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_4 = 1 and ERABSETUPFAILURE3GPPCAUSE_4 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_5 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_5 = 1 and ERABSETUPFAILURE3GPPCAUSE_5 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_6 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_6 = 1 and ERABSETUPFAILURE3GPPCAUSE_6 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_7 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_7 = 1 and ERABSETUPFAILURE3GPPCAUSE_7 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_8 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_8 = 1 and ERABSETUPFAILURE3GPPCAUSE_8 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_9 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_9 = 1 and ERABSETUPFAILURE3GPPCAUSE_9 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_10 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_10 = 1 and ERABSETUPFAILURE3GPPCAUSE_10 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_11 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_11 = 1 and ERABSETUPFAILURE3GPPCAUSE_11 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_12 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_12 = 1 and ERABSETUPFAILURE3GPPCAUSE_12 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_13 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_13 = 1 and ERABSETUPFAILURE3GPPCAUSE_13 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_14 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_14 = 1 and ERABSETUPFAILURE3GPPCAUSE_14 = 1 then 1 else 0 end) +
(case when ERABSETUPRESULT_15 != 0 and ERABSETUPFAILURE3GPPCAUSEGROUP_15 = 1 and ERABSETUPFAILURE3GPPCAUSE_15 = 1 then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

Update EVENT_4106 set CpmErabEstabSuccInitPaLsm = (case when ERABSETUPRESULT = 0 and ERABSETUPSUCCACCTYPE = 2  then 1 else 0 end) + 
(case when ERABSETUPRESULT_1 = 0 and ERABSETUPSUCCACCTYPE_1 = 2  then 1 else 0 end) +
(case when ERABSETUPRESULT_2 = 0 and ERABSETUPSUCCACCTYPE_2 = 2  then 1 else 0 end) +
(case when ERABSETUPRESULT_3 = 0 and ERABSETUPSUCCACCTYPE_3 = 2  then 1 else 0 end) +
(case when ERABSETUPRESULT_4 = 0 and ERABSETUPSUCCACCTYPE_4 = 2  then 1 else 0 end) +
(case when ERABSETUPRESULT_5 = 0 and ERABSETUPSUCCACCTYPE_5 = 2  then 1 else 0 end) +
(case when ERABSETUPRESULT_6 = 0 and ERABSETUPSUCCACCTYPE_6 = 2  then 1 else 0 end) +
(case when ERABSETUPRESULT_7 = 0 and ERABSETUPSUCCACCTYPE_7 = 2  then 1 else 0 end) +
(case when ERABSETUPRESULT_8 = 0 and ERABSETUPSUCCACCTYPE_8 = 2  then 1 else 0 end) +
(case when ERABSETUPRESULT_9 = 0 and ERABSETUPSUCCACCTYPE_9 = 2  then 1 else 0 end) +
(case when ERABSETUPRESULT_10 = 0 and ERABSETUPSUCCACCTYPE_10 = 2  then 1 else 0 end) +
(case when ERABSETUPRESULT_11 = 0 and ERABSETUPSUCCACCTYPE_11 = 2  then 1 else 0 end) +
(case when ERABSETUPRESULT_12 = 0 and ERABSETUPSUCCACCTYPE_12 = 2  then 1 else 0 end) +
(case when ERABSETUPRESULT_13 = 0 and ERABSETUPSUCCACCTYPE_13 = 2  then 1 else 0 end) +
(case when ERABSETUPRESULT_14 = 0 and ERABSETUPSUCCACCTYPE_14 = 2  then 1 else 0 end) +
(case when ERABSETUPRESULT_15 = 0 and ERABSETUPSUCCACCTYPE_15 = 2  then 1 else 0 end)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

--CpmErabEstabTimeInitDistrQci$

UPDATE EVENT_4106 SET  CpmErabEstabTimeInitDistrQci1 = 
(
(case when (ERABSETUPRESULT_1 = 0 and ERABSETUPREQQCI = 1) then 1 else 0 end)+
(case when (ERABSETUPRESULT_2 = 0 and ERABSETUPREQQCI_2 = 1) then 1 else 0 end) +
(case when (ERABSETUPRESULT_3 = 0 and ERABSETUPREQQCI_3 = 1) then 1 else 0 end) +
(case when (ERABSETUPRESULT_4 = 0 and ERABSETUPREQQCI_4 = 1) then 1 else 0 end)+
(case when (ERABSETUPRESULT_5 = 0 and ERABSETUPREQQCI_5 = 1) then 1 else 0 end)+
(case when (ERABSETUPRESULT_6 = 0 and ERABSETUPREQQCI_6 = 1) then 1 else 0 end)+
(case when (ERABSETUPRESULT_7 = 0 and ERABSETUPREQQCI_7 = 1) then 1 else 0 end)+
(case when (ERABSETUPRESULT_8 = 0 and ERABSETUPREQQCI_8 = 1) then 1 else 0 end)+
(case when (ERABSETUPRESULT_9 = 0 and ERABSETUPREQQCI_9 = 1) then 1 else 0 end)+
(case when (ERABSETUPRESULT_10 = 0 and ERABSETUPREQQCI_10 = 1) then 1 else 0 end)+
(case when (ERABSETUPRESULT_11 = 0 and ERABSETUPREQQCI_11 = 1) then 1 else 0 end)+
(case when (ERABSETUPRESULT_12 = 0 and ERABSETUPREQQCI_12 = 1) then 1 else 0 end)+
(case when (ERABSETUPRESULT_13 = 0 and ERABSETUPREQQCI_13 = 1) then 1 else 0 end)+
(case when (ERABSETUPRESULT_14 = 0 and ERABSETUPREQQCI_14 = 1) then 1 else 0 end) +
(case when (ERABSETUPRESULT_15 = 0 and ERABSETUPREQQCI_15 = 1) then 1 else 0 end))
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

UPDATE EVENT_4106 SET  CpmErabEstabTimeInitDistrQci2 = 
(
(case when (ERABSETUPRESULT_1  = 0 and ERABSETUPREQQCI =   2) then 1 else 0 end)+
(case when (ERABSETUPRESULT_2  = 0 and ERABSETUPREQQCI_2 = 2) then 1 else 0 end) +
(case when (ERABSETUPRESULT_3  = 0 and ERABSETUPREQQCI_3 = 2) then 1 else 0 end) +
(case when (ERABSETUPRESULT_4  = 0 and ERABSETUPREQQCI_4 = 2) then 1 else 0 end)+
(case when (ERABSETUPRESULT_5  = 0 and ERABSETUPREQQCI_5 = 2) then 1 else 0 end)+
(case when (ERABSETUPRESULT_6  = 0 and ERABSETUPREQQCI_6 = 2) then 1 else 0 end)+
(case when (ERABSETUPRESULT_7  = 0 and ERABSETUPREQQCI_7 = 2) then 1 else 0 end)+
(case when (ERABSETUPRESULT_8  = 0 and ERABSETUPREQQCI_8 = 2) then 1 else 0 end)+
(case when (ERABSETUPRESULT_9  = 0 and ERABSETUPREQQCI_9 = 2) then 1 else 0 end)+
(case when (ERABSETUPRESULT_10 = 0 and ERABSETUPREQQCI_10 =2)  then 1 else 0 end)+
(case when (ERABSETUPRESULT_11 = 0 and ERABSETUPREQQCI_11 =2)  then 1 else 0 end)+
(case when (ERABSETUPRESULT_12 = 0 and ERABSETUPREQQCI_12 =2)  then 1 else 0 end)+
(case when (ERABSETUPRESULT_13 = 0 and ERABSETUPREQQCI_13 =2)  then 1 else 0 end)+
(case when (ERABSETUPRESULT_14 = 0 and ERABSETUPREQQCI_14 =2)  then 1 else 0 end) +
(case when (ERABSETUPRESULT_15 = 0 and ERABSETUPREQQCI_15 =2)  then 1 else 0 end))
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

UPDATE EVENT_4106 SET  CpmErabEstabTimeInitDistrQci3 = 
(
(case when (ERABSETUPRESULT_1  = 0 and ERABSETUPREQQCI =   3) then 1 else 0 end)+
(case when (ERABSETUPRESULT_2  = 0 and ERABSETUPREQQCI_2 = 3) then 1 else 0 end) +
(case when (ERABSETUPRESULT_3  = 0 and ERABSETUPREQQCI_3 = 3) then 1 else 0 end) +
(case when (ERABSETUPRESULT_4  = 0 and ERABSETUPREQQCI_4 = 3) then 1 else 0 end)+
(case when (ERABSETUPRESULT_5  = 0 and ERABSETUPREQQCI_5 = 3) then 1 else 0 end)+
(case when (ERABSETUPRESULT_6  = 0 and ERABSETUPREQQCI_6 = 3) then 1 else 0 end)+
(case when (ERABSETUPRESULT_7  = 0 and ERABSETUPREQQCI_7 = 3) then 1 else 0 end)+
(case when (ERABSETUPRESULT_8  = 0 and ERABSETUPREQQCI_8 = 3) then 1 else 0 end)+
(case when (ERABSETUPRESULT_9  = 0 and ERABSETUPREQQCI_9 = 3) then 1 else 0 end)+
(case when (ERABSETUPRESULT_10 = 0 and ERABSETUPREQQCI_10 =3)  then 1 else 0 end)+
(case when (ERABSETUPRESULT_11 = 0 and ERABSETUPREQQCI_11 =3)  then 1 else 0 end)+
(case when (ERABSETUPRESULT_12 = 0 and ERABSETUPREQQCI_12 =3)  then 1 else 0 end)+
(case when (ERABSETUPRESULT_13 = 0 and ERABSETUPREQQCI_13 =3)  then 1 else 0 end)+
(case when (ERABSETUPRESULT_14 = 0 and ERABSETUPREQQCI_14 =3)  then 1 else 0 end) +
(case when (ERABSETUPRESULT_15 = 0 and ERABSETUPREQQCI_15 =3)  then 1 else 0 end))
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

UPDATE EVENT_4106 SET  CpmErabEstabTimeInitDistrQci4 = 
(
(case when (ERABSETUPRESULT_1  = 0 and ERABSETUPREQQCI =   4) then 1 else 0 end)+
(case when (ERABSETUPRESULT_2  = 0 and ERABSETUPREQQCI_2 = 4) then 1 else 0 end) +
(case when (ERABSETUPRESULT_3  = 0 and ERABSETUPREQQCI_3 = 4) then 1 else 0 end) +
(case when (ERABSETUPRESULT_4  = 0 and ERABSETUPREQQCI_4 = 4) then 1 else 0 end)+
(case when (ERABSETUPRESULT_5  = 0 and ERABSETUPREQQCI_5 = 4) then 1 else 0 end)+
(case when (ERABSETUPRESULT_6  = 0 and ERABSETUPREQQCI_6 = 4) then 1 else 0 end)+
(case when (ERABSETUPRESULT_7  = 0 and ERABSETUPREQQCI_7 = 4) then 1 else 0 end)+
(case when (ERABSETUPRESULT_8  = 0 and ERABSETUPREQQCI_8 = 4) then 1 else 0 end)+
(case when (ERABSETUPRESULT_9  = 0 and ERABSETUPREQQCI_9 = 4) then 1 else 0 end)+
(case when (ERABSETUPRESULT_10 = 0 and ERABSETUPREQQCI_10 =4)  then 1 else 0 end)+
(case when (ERABSETUPRESULT_11 = 0 and ERABSETUPREQQCI_11 =4)  then 1 else 0 end)+
(case when (ERABSETUPRESULT_12 = 0 and ERABSETUPREQQCI_12 =4)  then 1 else 0 end)+
(case when (ERABSETUPRESULT_13 = 0 and ERABSETUPREQQCI_13 =4)  then 1 else 0 end)+
(case when (ERABSETUPRESULT_14 = 0 and ERABSETUPREQQCI_14 =4)  then 1 else 0 end) +
(case when (ERABSETUPRESULT_15 = 0 and ERABSETUPREQQCI_15 =4)  then 1 else 0 end))
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

UPDATE EVENT_4106 SET  CpmErabEstabTimeInitDistrQci5 = 
(
(case when (ERABSETUPRESULT_1  = 0 and ERABSETUPREQQCI =   5) then 1 else 0 end)+
(case when (ERABSETUPRESULT_2  = 0 and ERABSETUPREQQCI_2 = 5) then 1 else 0 end) +
(case when (ERABSETUPRESULT_3  = 0 and ERABSETUPREQQCI_3 = 5) then 1 else 0 end) +
(case when (ERABSETUPRESULT_4  = 0 and ERABSETUPREQQCI_4 = 5) then 1 else 0 end)+
(case when (ERABSETUPRESULT_5  = 0 and ERABSETUPREQQCI_5 = 5) then 1 else 0 end)+
(case when (ERABSETUPRESULT_6  = 0 and ERABSETUPREQQCI_6 = 5) then 1 else 0 end)+
(case when (ERABSETUPRESULT_7  = 0 and ERABSETUPREQQCI_7 = 5) then 1 else 0 end)+
(case when (ERABSETUPRESULT_8  = 0 and ERABSETUPREQQCI_8 = 5) then 1 else 0 end)+
(case when (ERABSETUPRESULT_9  = 0 and ERABSETUPREQQCI_9 = 5) then 1 else 0 end)+
(case when (ERABSETUPRESULT_10 = 0 and ERABSETUPREQQCI_10 =5)  then 1 else 0 end)+
(case when (ERABSETUPRESULT_11 = 0 and ERABSETUPREQQCI_11 =5)  then 1 else 0 end)+
(case when (ERABSETUPRESULT_12 = 0 and ERABSETUPREQQCI_12 =5)  then 1 else 0 end)+
(case when (ERABSETUPRESULT_13 = 0 and ERABSETUPREQQCI_13 =5)  then 1 else 0 end)+
(case when (ERABSETUPRESULT_14 = 0 and ERABSETUPREQQCI_14 =5)  then 1 else 0 end) +
(case when (ERABSETUPRESULT_15 = 0 and ERABSETUPREQQCI_15 =5)  then 1 else 0 end))
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

UPDATE EVENT_4106 SET  CpmErabEstabTimeInitDistrQci6 = 
(
(case when (ERABSETUPRESULT_1  = 0 and ERABSETUPREQQCI =   6) then 1 else 0 end)+
(case when (ERABSETUPRESULT_2  = 0 and ERABSETUPREQQCI_2 = 6) then 1 else 0 end) +
(case when (ERABSETUPRESULT_3  = 0 and ERABSETUPREQQCI_3 = 6) then 1 else 0 end) +
(case when (ERABSETUPRESULT_4  = 0 and ERABSETUPREQQCI_4 = 6) then 1 else 0 end)+
(case when (ERABSETUPRESULT_5  = 0 and ERABSETUPREQQCI_5 = 6) then 1 else 0 end)+
(case when (ERABSETUPRESULT_6  = 0 and ERABSETUPREQQCI_6 = 6) then 1 else 0 end)+
(case when (ERABSETUPRESULT_7  = 0 and ERABSETUPREQQCI_7 = 6) then 1 else 0 end)+
(case when (ERABSETUPRESULT_8  = 0 and ERABSETUPREQQCI_8 = 6) then 1 else 0 end)+
(case when (ERABSETUPRESULT_9  = 0 and ERABSETUPREQQCI_9 = 6) then 1 else 0 end)+
(case when (ERABSETUPRESULT_10 = 0 and ERABSETUPREQQCI_10 =6)  then 1 else 0 end)+
(case when (ERABSETUPRESULT_11 = 0 and ERABSETUPREQQCI_11 =6)  then 1 else 0 end)+
(case when (ERABSETUPRESULT_12 = 0 and ERABSETUPREQQCI_12 =6)  then 1 else 0 end)+
(case when (ERABSETUPRESULT_13 = 0 and ERABSETUPREQQCI_13 =6)  then 1 else 0 end)+
(case when (ERABSETUPRESULT_14 = 0 and ERABSETUPREQQCI_14 =6)  then 1 else 0 end) +
(case when (ERABSETUPRESULT_15 = 0 and ERABSETUPREQQCI_15 =6)  then 1 else 0 end))
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

UPDATE EVENT_4106 SET  CpmErabEstabTimeInitDistrQci7 = 
(
(case when (ERABSETUPRESULT_1  = 0 and ERABSETUPREQQCI =   7) then 1 else 0 end)+
(case when (ERABSETUPRESULT_2  = 0 and ERABSETUPREQQCI_2 = 7) then 1 else 0 end) +
(case when (ERABSETUPRESULT_3  = 0 and ERABSETUPREQQCI_3 = 7) then 1 else 0 end) +
(case when (ERABSETUPRESULT_4  = 0 and ERABSETUPREQQCI_4 = 7) then 1 else 0 end)+
(case when (ERABSETUPRESULT_5  = 0 and ERABSETUPREQQCI_5 = 7) then 1 else 0 end)+
(case when (ERABSETUPRESULT_6  = 0 and ERABSETUPREQQCI_6 = 7) then 1 else 0 end)+
(case when (ERABSETUPRESULT_7  = 0 and ERABSETUPREQQCI_7 = 7) then 1 else 0 end)+
(case when (ERABSETUPRESULT_8  = 0 and ERABSETUPREQQCI_8 = 7) then 1 else 0 end)+
(case when (ERABSETUPRESULT_9  = 0 and ERABSETUPREQQCI_9 = 7) then 1 else 0 end)+
(case when (ERABSETUPRESULT_10 = 0 and ERABSETUPREQQCI_10 =7)  then 1 else 0 end)+
(case when (ERABSETUPRESULT_11 = 0 and ERABSETUPREQQCI_11 =7)  then 1 else 0 end)+
(case when (ERABSETUPRESULT_12 = 0 and ERABSETUPREQQCI_12 =7)  then 1 else 0 end)+
(case when (ERABSETUPRESULT_13 = 0 and ERABSETUPREQQCI_13 =7)  then 1 else 0 end)+
(case when (ERABSETUPRESULT_14 = 0 and ERABSETUPREQQCI_14 =7)  then 1 else 0 end) +
(case when (ERABSETUPRESULT_15 = 0 and ERABSETUPREQQCI_15 =7)  then 1 else 0 end))
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

UPDATE EVENT_4106 SET  CpmErabEstabTimeInitDistrQci8 = 
(
(case when (ERABSETUPRESULT_1  = 0 and ERABSETUPREQQCI =   8) then 1 else 0 end)+
(case when (ERABSETUPRESULT_2  = 0 and ERABSETUPREQQCI_2 = 8) then 1 else 0 end) +
(case when (ERABSETUPRESULT_3  = 0 and ERABSETUPREQQCI_3 = 8) then 1 else 0 end) +
(case when (ERABSETUPRESULT_4  = 0 and ERABSETUPREQQCI_4 = 8) then 1 else 0 end)+
(case when (ERABSETUPRESULT_5  = 0 and ERABSETUPREQQCI_5 = 8) then 1 else 0 end)+
(case when (ERABSETUPRESULT_6  = 0 and ERABSETUPREQQCI_6 = 8) then 1 else 0 end)+
(case when (ERABSETUPRESULT_7  = 0 and ERABSETUPREQQCI_7 = 8) then 1 else 0 end)+
(case when (ERABSETUPRESULT_8  = 0 and ERABSETUPREQQCI_8 = 8) then 1 else 0 end)+
(case when (ERABSETUPRESULT_9  = 0 and ERABSETUPREQQCI_9 = 8) then 1 else 0 end)+
(case when (ERABSETUPRESULT_10 = 0 and ERABSETUPREQQCI_10 =8)  then 1 else 0 end)+
(case when (ERABSETUPRESULT_11 = 0 and ERABSETUPREQQCI_11 =8)  then 1 else 0 end)+
(case when (ERABSETUPRESULT_12 = 0 and ERABSETUPREQQCI_12 =8)  then 1 else 0 end)+
(case when (ERABSETUPRESULT_13 = 0 and ERABSETUPREQQCI_13 =8)  then 1 else 0 end)+
(case when (ERABSETUPRESULT_14 = 0 and ERABSETUPREQQCI_14 =8)  then 1 else 0 end) +
(case when (ERABSETUPRESULT_15 = 0 and ERABSETUPREQQCI_15 =8)  then 1 else 0 end))
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;


UPDATE EVENT_4106 SET  CpmErabEstabTimeInitDistrQci9 = 
(
(case when (ERABSETUPRESULT_1  = 0 and ERABSETUPREQQCI =   9) then 1 else 0 end)+
(case when (ERABSETUPRESULT_2  = 0 and ERABSETUPREQQCI_2 = 9) then 1 else 0 end) +
(case when (ERABSETUPRESULT_3  = 0 and ERABSETUPREQQCI_3 = 9) then 1 else 0 end) +
(case when (ERABSETUPRESULT_4  = 0 and ERABSETUPREQQCI_4 = 9) then 1 else 0 end)+
(case when (ERABSETUPRESULT_5  = 0 and ERABSETUPREQQCI_5 = 9) then 1 else 0 end)+
(case when (ERABSETUPRESULT_6  = 0 and ERABSETUPREQQCI_6 = 9) then 1 else 0 end)+
(case when (ERABSETUPRESULT_7  = 0 and ERABSETUPREQQCI_7 = 9) then 1 else 0 end)+
(case when (ERABSETUPRESULT_8  = 0 and ERABSETUPREQQCI_8 = 9) then 1 else 0 end)+
(case when (ERABSETUPRESULT_9  = 0 and ERABSETUPREQQCI_9 = 9) then 1 else 0 end)+
(case when (ERABSETUPRESULT_10 = 0 and ERABSETUPREQQCI_10 =9)  then 1 else 0 end)+
(case when (ERABSETUPRESULT_11 = 0 and ERABSETUPREQQCI_11 =9)  then 1 else 0 end)+
(case when (ERABSETUPRESULT_12 = 0 and ERABSETUPREQQCI_12 =9)  then 1 else 0 end)+
(case when (ERABSETUPRESULT_13 = 0 and ERABSETUPREQQCI_13 =9)  then 1 else 0 end)+
(case when (ERABSETUPRESULT_14 = 0 and ERABSETUPREQQCI_14 =9)  then 1 else 0 end) +
(case when (ERABSETUPRESULT_15 = 0 and ERABSETUPREQQCI_15 =9)  then 1 else 0 end))
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

--CpmErabEstabTimeInitMaxQci$

--CpmErabEstabTimeInitSumQci$
UPDATE EVENT_4106 SET  CpmErabEstabTimeInitSumQci1 = 
(
case when (ERABSETUPRESULT = 0 and ERABSETUPREQQCI = 1) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOpmILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOpmINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_1 = 0 and ERABSETUPREQQCI_1 = 1) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_2 = 0 and ERABSETUPREQQCI_2 = 1) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_3 = 0 and ERABSETUPREQQCI_3 = 1) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end +
case when (ERABSETUPRESULT_4 = 0 and ERABSETUPREQQCI_4 = 1) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_5 = 0 and ERABSETUPREQQCI_5 = 1) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_6 = 0 and ERABSETUPREQQCI_6 = 1) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_7 = 0 and ERABSETUPREQQCI_7 = 1) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_8 = 0 and ERABSETUPREQQCI_8 = 1) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end +
case when (ERABSETUPRESULT_9 = 0 and ERABSETUPREQQCI_9 = 1) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_10 = 0 and ERABSETUPREQQCI_10 = 1) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_11 = 0 and ERABSETUPREQQCI_11 = 1) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_12 = 0 and ERABSETUPREQQCI_12 = 1) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_13 = 0 and ERABSETUPREQQCI_13 = 1) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_14 = 0 and ERABSETUPREQQCI_14 = 1) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_15 = 0 and ERABSETUPREQQCI_15 = 1) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end 
)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;


UPDATE EVENT_4106 SET  CpmErabEstabTimeInitSumQci2 = 
(
case when (ERABSETUPRESULT = 0 and ERABSETUPREQQCI = 2) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_1 = 0 and ERABSETUPREQQCI_1 = 2) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_2 = 0 and ERABSETUPREQQCI_2 = 2) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_3 = 0 and ERABSETUPREQQCI_3 = 2) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end +
case when (ERABSETUPRESULT_4 = 0 and ERABSETUPREQQCI_4 = 2) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_5 = 0 and ERABSETUPREQQCI_5 = 2) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_6 = 0 and ERABSETUPREQQCI_6 = 2) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_7 = 0 and ERABSETUPREQQCI_7 = 2) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_8 = 0 and ERABSETUPREQQCI_8 = 2) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end +
case when (ERABSETUPRESULT_9 = 0 and ERABSETUPREQQCI_9 = 2) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_10 = 0 and ERABSETUPREQQCI_10 = 2) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_11 = 0 and ERABSETUPREQQCI_11 = 2) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_12 = 0 and ERABSETUPREQQCI_12 = 2) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_13 = 0 and ERABSETUPREQQCI_13 = 2) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_14 = 0 and ERABSETUPREQQCI_14 = 2) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_15 = 0 and ERABSETUPREQQCI_15 = 2) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end 
)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;
-------------
UPDATE EVENT_4106 SET  CpmErabEstabTimeInitSumQci3 = 
(
case when (ERABSETUPRESULT = 0 and ERABSETUPREQQCI = 3) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_1 = 0 and ERABSETUPREQQCI_1 = 3) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_2 = 0 and ERABSETUPREQQCI_2 = 3) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_3 = 0 and ERABSETUPREQQCI_3 = 3) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end +
case when (ERABSETUPRESULT_4 = 0 and ERABSETUPREQQCI_4 = 3) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_5 = 0 and ERABSETUPREQQCI_5 = 3) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_6 = 0 and ERABSETUPREQQCI_6 = 3) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_7 = 0 and ERABSETUPREQQCI_7 = 3) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_8 = 0 and ERABSETUPREQQCI_8 = 3) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end +
case when (ERABSETUPRESULT_9 = 0 and ERABSETUPREQQCI_9 = 3) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_10 = 0 and ERABSETUPREQQCI_10 = 3) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_11 = 0 and ERABSETUPREQQCI_11 = 3) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_12 = 0 and ERABSETUPREQQCI_12 = 3) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_13 = 0 and ERABSETUPREQQCI_13 = 3) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_14 = 0 and ERABSETUPREQQCI_14 = 3) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_15 = 0 and ERABSETUPREQQCI_15 = 3) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end 
)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

UPDATE EVENT_4106 SET  CpmErabEstabTimeInitSumQci4 = 
(
case when (ERABSETUPRESULT = 0 and ERABSETUPREQQCI = 4) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_1 = 0 and ERABSETUPREQQCI_1 = 4) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_2 = 0 and ERABSETUPREQQCI_2 = 4) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_3 = 0 and ERABSETUPREQQCI_3 = 4) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end +
case when (ERABSETUPRESULT_4 = 0 and ERABSETUPREQQCI_4 = 4) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_5 = 0 and ERABSETUPREQQCI_5 = 4) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_6 = 0 and ERABSETUPREQQCI_6 = 4) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_7 = 0 and ERABSETUPREQQCI_7 = 4) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_8 = 0 and ERABSETUPREQQCI_8 = 4) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end +
case when (ERABSETUPRESULT_9 = 0 and ERABSETUPREQQCI_9 = 4) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_10 = 0 and ERABSETUPREQQCI_10 = 4) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_11 = 0 and ERABSETUPREQQCI_11 = 4) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_12 = 0 and ERABSETUPREQQCI_12 = 4) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_13 = 0 and ERABSETUPREQQCI_13 = 4) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_14 = 0 and ERABSETUPREQQCI_14 = 4) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_15 = 0 and ERABSETUPREQQCI_15 = 4) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end 
)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

UPDATE EVENT_4106 SET  CpmErabEstabTimeInitSumQci5 = 
(
case when (ERABSETUPRESULT = 0 and ERABSETUPREQQCI = 5) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_1 = 0 and ERABSETUPREQQCI_1 = 5) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_2 = 0 and ERABSETUPREQQCI_2 = 5) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_3 = 0 and ERABSETUPREQQCI_3 = 5) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end +
case when (ERABSETUPRESULT_4 = 0 and ERABSETUPREQQCI_4 = 5) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_5 = 0 and ERABSETUPREQQCI_5 = 5) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_6 = 0 and ERABSETUPREQQCI_6 = 5) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_7 = 0 and ERABSETUPREQQCI_7 = 5) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_8 = 0 and ERABSETUPREQQCI_8 = 5) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end +
case when (ERABSETUPRESULT_9 = 0 and ERABSETUPREQQCI_9 = 5) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_10 = 0 and ERABSETUPREQQCI_10 = 5) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_11 = 0 and ERABSETUPREQQCI_11 = 5) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_12 = 0 and ERABSETUPREQQCI_12 = 5) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_13 = 0 and ERABSETUPREQQCI_13 = 5) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_14 = 0 and ERABSETUPREQQCI_14 = 5) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_15 = 0 and ERABSETUPREQQCI_15 = 5) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end 
)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

UPDATE EVENT_4106 SET  CpmErabEstabTimeInitSumQci6 = 
(
case when (ERABSETUPRESULT = 0 and ERABSETUPREQQCI = 6) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_1 = 0 and ERABSETUPREQQCI_1 = 6) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_2 = 0 and ERABSETUPREQQCI_2 = 6) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_3 = 0 and ERABSETUPREQQCI_3 = 6) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end +
case when (ERABSETUPRESULT_4 = 0 and ERABSETUPREQQCI_4 = 6) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_5 = 0 and ERABSETUPREQQCI_5 = 6) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_6 = 0 and ERABSETUPREQQCI_6 = 6) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_7 = 0 and ERABSETUPREQQCI_7 = 6) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_8 = 0 and ERABSETUPREQQCI_8 = 6) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end +
case when (ERABSETUPRESULT_9 = 0 and ERABSETUPREQQCI_9 = 6) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_10 = 0 and ERABSETUPREQQCI_10 = 6) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_11 = 0 and ERABSETUPREQQCI_11 = 6) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_12 = 0 and ERABSETUPREQQCI_12 = 6) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_13 = 0 and ERABSETUPREQQCI_13 = 6) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_14 = 0 and ERABSETUPREQQCI_14 = 6) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_15 = 0 and ERABSETUPREQQCI_15 = 6) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end 
)
from EVENT_4106 A inner join topo_eucell B
on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

UPDATE EVENT_4106 SET  CpmErabEstabTimeInitSumQci7 = 
(
case when (ERABSETUPRESULT = 0 and ERABSETUPREQQCI = 7) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_1 = 0 and ERABSETUPREQQCI_1 = 7) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_2 = 0 and ERABSETUPREQQCI_2 = 7) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_3 = 0 and ERABSETUPREQQCI_3 = 7) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end +
case when (ERABSETUPRESULT_4 = 0 and ERABSETUPREQQCI_4 = 7) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_5 = 0 and ERABSETUPREQQCI_5 = 7) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_6 = 0 and ERABSETUPREQQCI_6 = 7) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_7 = 0 and ERABSETUPREQQCI_7 = 7) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_8 = 0 and ERABSETUPREQQCI_8 = 7) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end +
case when (ERABSETUPRESULT_9 = 0 and ERABSETUPREQQCI_9 = 7) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_10 = 0 and ERABSETUPREQQCI_10 = 7) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_11 = 0 and ERABSETUPREQQCI_11 = 7) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_12 = 0 and ERABSETUPREQQCI_12 = 7) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_13 = 0 and ERABSETUPREQQCI_13 = 7) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_14 = 0 and ERABSETUPREQQCI_14 = 7) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_15 = 0 and ERABSETUPREQQCI_15 = 7) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end 
)
from EVENT_4106 A inner join topo_eucell B
on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

UPDATE EVENT_4106 SET  CpmErabEstabTimeInitSumQci8 = 
(
case when (ERABSETUPRESULT = 0 and ERABSETUPREQQCI = 8) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_1 = 0 and ERABSETUPREQQCI_1 = 8) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_2 = 0 and ERABSETUPREQQCI_2 = 8) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_3 = 0 and ERABSETUPREQQCI_3 = 8) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end +
case when (ERABSETUPRESULT_4 = 0 and ERABSETUPREQQCI_4 = 8) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_5 = 0 and ERABSETUPREQQCI_5 = 8) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_6 = 0 and ERABSETUPREQQCI_6 = 8) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_7 = 0 and ERABSETUPREQQCI_7 = 8) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_8 = 0 and ERABSETUPREQQCI_8 = 8) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end +
case when (ERABSETUPRESULT_9 = 0 and ERABSETUPREQQCI_9 = 8) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_10 = 0 and ERABSETUPREQQCI_10 = 8) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_11 = 0 and ERABSETUPREQQCI_11 = 8) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_12 = 0 and ERABSETUPREQQCI_12 = 8) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_13 = 0 and ERABSETUPREQQCI_13 = 8) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_14 = 0 and ERABSETUPREQQCI_14 = 8) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_15 = 0 and ERABSETUPREQQCI_15 = 8) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end 
)
from EVENT_4106 A inner join topo_eucell B
on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;

UPDATE EVENT_4106 SET  CpmErabEstabTimeInitSumQci9 = 
(
case when (ERABSETUPRESULT = 0 and ERABSETUPREQQCI = 9) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_1 = 0 and ERABSETUPREQQCI_1 = 9) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_2 = 0 and ERABSETUPREQQCI_2 = 9) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_3 = 0 and ERABSETUPREQQCI_3 = 9) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end +
case when (ERABSETUPRESULT_4 = 0 and ERABSETUPREQQCI_4 = 9) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_5 = 0 and ERABSETUPREQQCI_5 = 9) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_6 = 0 and ERABSETUPREQQCI_6 = 9) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_7 = 0 and ERABSETUPREQQCI_7 = 9) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_8 = 0 and ERABSETUPREQQCI_8 = 9) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end +
case when (ERABSETUPRESULT_9 = 0 and ERABSETUPREQQCI_9 = 9) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_10 = 0 and ERABSETUPREQQCI_10 = 9) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_11 = 0 and ERABSETUPREQQCI_11 = 9) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_12 = 0 and ERABSETUPREQQCI_12 = 9) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_13 = 0 and ERABSETUPREQQCI_13 = 9) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_14 = 0 and ERABSETUPREQQCI_14 = 9) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end  +
case when (ERABSETUPRESULT_15 = 0 and ERABSETUPREQQCI_15 = 9) then
(
case when MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) >= 0 
then 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000) 
else 
MOD(
((TIMESTAMPSTOPHOUR-TIMESTAMPSTARTHOUR)*3600000) +
((TIMESTAMPSTOPMINUTE-TIMESTAMPSTARTMINUTE)*60000) + 
((TIMESTAMPSTOPSECOND-TIMESTAMPSTARTSECOND)*1000) 
+(TIMESTAMPSTOPMILLISEC-TIMESTAMPSTARTMILLISEC)
,3600000)+3600000 end
) else 0 end 
)
from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID;
Update EVENT_4106 set CpmUeCtxtEstabFailMiscS1Cause0 = 1 from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID where INITIALCTXTRESULT != 0  AND a3GPPCAUSEGROUP = 4 AND a3GPPCAUSE=0;
Update EVENT_4106 set CpmUeCtxtEstabFailMiscS1Cause1 = 1 from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID where INITIALCTXTRESULT != 0  AND a3GPPCAUSEGROUP = 4 AND a3GPPCAUSE=1;
Update EVENT_4106 set CpmUeCtxtEstabFailMiscS1Cause2 = 1 from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID where INITIALCTXTRESULT != 0  AND a3GPPCAUSEGROUP = 4 AND a3GPPCAUSE=2;
Update EVENT_4106 set CpmUeCtxtEstabFailMiscS1Cause3 = 1 from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID where INITIALCTXTRESULT != 0  AND a3GPPCAUSEGROUP = 4 AND a3GPPCAUSE=3;
Update EVENT_4106 set CpmUeCtxtEstabFailMiscS1Cause4 = 1 from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID where INITIALCTXTRESULT != 0  AND a3GPPCAUSEGROUP = 4 AND a3GPPCAUSE=4;
Update EVENT_4106 set CpmUeCtxtEstabFailMiscS1Cause5 = 1 from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID where INITIALCTXTRESULT != 0  AND a3GPPCAUSEGROUP = 4 AND a3GPPCAUSE=5;
Update EVENT_4106 set CpmUeCtxtEstabFailNasS1Cause0 = 1 from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID where INITIALCTXTRESULT != 0  AND a3GPPCAUSEGROUP = 2 AND a3GPPCAUSE=0;
Update EVENT_4106 set CpmUeCtxtEstabFailNasS1Cause1 = 1 from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID where INITIALCTXTRESULT != 0  AND a3GPPCAUSEGROUP = 2 AND a3GPPCAUSE=1;
Update EVENT_4106 set CpmUeCtxtEstabFailNasS1Cause2 = 1 from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID where INITIALCTXTRESULT != 0  AND a3GPPCAUSEGROUP = 2 AND a3GPPCAUSE=2;
Update EVENT_4106 set CpmUeCtxtEstabFailNasS1Cause3 = 1 from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID where INITIALCTXTRESULT != 0  AND a3GPPCAUSEGROUP = 2 AND a3GPPCAUSE=3;
Update EVENT_4106 set CpmUeCtxtEstabFailNasS1Cause4 = 1 from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID where INITIALCTXTRESULT != 0  AND a3GPPCAUSEGROUP = 2 AND a3GPPCAUSE=4;
Update EVENT_4106 set CpmUeCtxtEstabFailProtS1Cause0 = 1 from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID where INITIALCTXTRESULT != 0  AND a3GPPCAUSEGROUP = 3 AND a3GPPCAUSE=0;
Update EVENT_4106 set CpmUeCtxtEstabFailProtS1Cause1 = 1 from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID where INITIALCTXTRESULT != 0  AND a3GPPCAUSEGROUP = 3 AND a3GPPCAUSE=1;
Update EVENT_4106 set CpmUeCtxtEstabFailProtS1Cause2 = 1 from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID where INITIALCTXTRESULT != 0  AND a3GPPCAUSEGROUP = 3 AND a3GPPCAUSE=2;
Update EVENT_4106 set CpmUeCtxtEstabFailProtS1Cause3 = 1 from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID where INITIALCTXTRESULT != 0  AND a3GPPCAUSEGROUP = 3 AND a3GPPCAUSE=3;
Update EVENT_4106 set CpmUeCtxtEstabFailProtS1Cause4 = 1 from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID where INITIALCTXTRESULT != 0  AND a3GPPCAUSEGROUP = 3 AND a3GPPCAUSE=4;
Update EVENT_4106 set CpmUeCtxtEstabFailProtS1Cause5 = 1 from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID where INITIALCTXTRESULT != 0  AND a3GPPCAUSEGROUP = 3 AND a3GPPCAUSE=5;
Update EVENT_4106 set CpmUeCtxtEstabFailProtS1Cause6 = 1 from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID where INITIALCTXTRESULT != 0  AND a3GPPCAUSEGROUP = 3 AND a3GPPCAUSE=6;
Update EVENT_4106 set CpmUeCtxtEstabFailRnlS1Cause0 = 1 from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID where INITIALCTXTRESULT != 0  AND a3GPPCAUSEGROUP = 0 AND a3GPPCAUSE=0;
Update EVENT_4106 set CpmUeCtxtEstabFailRnlS1Cause1 = 1 from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID where INITIALCTXTRESULT != 0  AND a3GPPCAUSEGROUP = 0 AND a3GPPCAUSE=1;
Update EVENT_4106 set CpmUeCtxtEstabFailRnlS1Cause2 = 1 from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID where INITIALCTXTRESULT != 0  AND a3GPPCAUSEGROUP = 0 AND a3GPPCAUSE=2;
Update EVENT_4106 set CpmUeCtxtEstabFailRnlS1Cause3 = 1 from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID where INITIALCTXTRESULT != 0  AND a3GPPCAUSEGROUP = 0 AND a3GPPCAUSE=3;
Update EVENT_4106 set CpmUeCtxtEstabFailRnlS1Cause4 = 1 from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID where INITIALCTXTRESULT != 0  AND a3GPPCAUSEGROUP = 0 AND a3GPPCAUSE=4;
Update EVENT_4106 set CpmUeCtxtEstabFailRnlS1Cause5 = 1 from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID where INITIALCTXTRESULT != 0  AND a3GPPCAUSEGROUP = 0 AND a3GPPCAUSE=5;
Update EVENT_4106 set CpmUeCtxtEstabFailRnlS1Cause6 = 1 from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID where INITIALCTXTRESULT != 0  AND a3GPPCAUSEGROUP = 0 AND a3GPPCAUSE=6;
Update EVENT_4106 set CpmUeCtxtEstabFailRnlS1Cause7 = 1 from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID where INITIALCTXTRESULT != 0  AND a3GPPCAUSEGROUP = 0 AND a3GPPCAUSE=7;
Update EVENT_4106 set CpmUeCtxtEstabFailRnlS1Cause8 = 1  from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID where INITIALCTXTRESULT != 0  AND a3GPPCAUSEGROUP = 0 AND a3GPPCAUSE=8;
Update EVENT_4106 set CpmUeCtxtEstabFailRnlS1Cause9 = 1 from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID where INITIALCTXTRESULT != 0  AND a3GPPCAUSEGROUP = 0 AND a3GPPCAUSE=9;
Update EVENT_4106 set CpmUeCtxtEstabFailRnlS1Cause10 = 1 from EVENT_4106 A inner join topo_eucell B on A.CELL_ID = B.CELL_ID and A.ENB_ID = B.ENB_ID where INITIALCTXTRESULT != 0